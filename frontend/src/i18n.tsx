import React, { createContext, useContext, useMemo, useState } from "react";

export type Locale = "zh" | "en";
export type TimeZone = "America/New_York" | "UTC" | "Asia/Shanghai" | "Asia/Hong_Kong";

type MessageTree = Record<string, MessageTree | string>;

const messages: Record<Locale, MessageTree> = {
  zh: {
    nav: {
      projects: "项目",
      themes: "主题库",
      algorithms: "算法",
      backtests: "回测&报告",
      reports: "报告",
      data: "数据",
      liveTrade: "实盘交易",
      audit: "系统审计",
    },
    app: {
      footer: "本地化量化平台 · Lean 引擎",
    },
    topbar: {
      localRunner: "本地执行器",
      leanEngine: "Lean 引擎",
      switchLanguage: "切换语言",
      timezone: "时区",
      timezoneOptions: {
        et: "美国东部时间 (ET)",
        utc: "协调世界时 (UTC)",
        cn: "中国标准时间 (CST)",
        hk: "香港时间 (HKT)",
      },
      localeShort: {
        zh: "中文",
        en: "EN",
      },
    },
    common: {
      none: "-",
      noneText: "无",
      boolean: {
        true: "是",
        false: "否",
      },
      status: {
        queued: "排队中",
        running: "运行中",
        success: "成功",
        failed: "失败",
        cancel_requested: "取消中",
        canceled: "已取消",
        skipped: "已跳过",
        connected: "已连接",
        disconnected: "未连接",
        unknown: "未知",
        ok: "正常",
        warn: "警告",
        rate_limited: "受限",
        not_found: "未覆盖",
      },
      actions: {
        create: "创建",
        save: "保存",
        saved: "已保存",
        saveVersion: "保存版本",
        start: "开始",
        compare: "开始对比",
        generateDiff: "生成 diff",
        run: "运行回测",
        view: "查看",
        download: "下载",
        query: "查询",
        refresh: "刷新",
        syncAll: "同步全部",
        scan: "执行扫描",
        loadCharts: "加载图表",
        loading: "加载中",
        close: "关闭",
      },
      labels: {
        id: "ID",
        status: "状态",
        createdAt: "创建时间",
        updatedAt: "更新时间",
        endedAt: "结束时间",
        actions: "操作",
      },
    },
    symbols: {
      types: {
        stock: "股票",
        etf: "ETF",
        adr: "ADR",
        reit: "REITs",
        etn: "ETN",
        fund: "基金",
        index: "指数",
        unknown: "未知",
      },
    },
    metrics: {
      cagr: "复合年化收益率（CAGR）",
      drawdown: "最大回撤",
      drawdownAll: "最大回撤(全程)",
      drawdown52w: "最大回撤(52周)",
      sharpe: "夏普比率",
      netProfit: "净收益",
      totalFees: "总手续费",
      turnover: "组合换手率",
      turnoverWeek: "周换手上限",
      turnoverWeekAvg: "周度换手率(均值)",
      turnoverWeekLast: "周度换手率(最新)",
      turnoverWeekAnnualized: "周度换手率年化(估算)",
      turnoverSanityRatio: "换手率对照(组合/周度均值)",
      riskStatus: "风控状态",
    },
    charts: {
      noData: "暂无数据",
      pointsSummary: "点数 {count}，起点 {start}，终点 {end}",
      equityCurve: "权益曲线（Strategy Equity）",
      drawdownCurve: "回撤曲线（Drawdown）",
      performanceTitle: "收益/回撤对比",
      performanceMeta: "整合收益、回撤、基准与仓位，支持叠加对比",
      toggleEquity: "收益",
      toggleDrawdown: "回撤",
      toggleBenchmark: "基准",
      toggleBenchmarkDrawdown: "基准回撤",
      toggleExposure: "仓位/现金",
      exposureModeRatio: "占比",
      exposureModeValue: "金额",
      legendDate: "日期",
      seriesEquity: "收益",
      seriesDrawdown: "回撤",
      seriesBenchmark: "基准",
      seriesBenchmarkDrawdown: "基准回撤",
      seriesLongExposure: "证券仓位",
      seriesDefensiveExposure: "防御资产",
      seriesCashExposure: "现金占比",
    },
    projects: {
      title: "项目管理",
      new: {
        title: "新建项目",
        meta: "用于组织算法与回测记录",
        name: "项目名称",
        description: "项目描述",
        errorName: "请输入项目名称",
      },
      overview: {
        title: "项目概览",
        meta: "当前项目数量",
      },
      list: {
        title: "项目列表",
        meta: "选择项目进行管理",
        search: "搜索项目名称",
        showArchived: "显示归档项目",
        archivedTag: "已归档",
        empty: "暂无项目",
      },
      detail: {
        empty: "请选择项目以查看详情",
        projectId: "项目ID",
        openThemes: "进入主题管理",
        archivedLabel: "已归档",
        archive: "归档项目",
        restore: "恢复项目",
        archiveConfirm: "确认归档项目「{name}」？归档后将隐藏。",
        restoreConfirm: "确认恢复项目「{name}」？",
        archiveSuccess: "项目已归档",
        restoreSuccess: "项目已恢复",
        archiveError: "项目归档失败",
        restoreError: "项目恢复失败",
        summaryTitle: "项目概览",
        summaryMeta: "核心配置与资产覆盖",
        themeTitle: "主题权重",
        themeMeta: "按权重查看主题分布",
        symbolsTotalLabel: "项目成分数量",
        performanceTitle: "最新回测",
        performanceMeta: "组合与基准关键指标",
      },
      tabs: {
        overview: "概览",
        config: "配置",
        algorithm: "算法",
        data: "数据",
        backtest: "回测",
        versions: "版本",
        diff: "对比",
      },
      table: {
        project: "项目",
        description: "描述",
        createdAt: "创建时间",
      },
      config: {
        title: "项目配置",
        meta: "配置成分范围、数据源与权重",
        universeMode: "成分范围",
        universeHistory: "历史成分（含退市）",
        universeCurrent: "当前成分",
        frequency: "数据周期",
        frequencyDaily: "日线",
        frequencyMinute: "分钟（需付费数据）",
        vendorPrimary: "主数据源",
        vendorFallback: "备数据源",
        vendorLockedHint: "数据源已锁定为 Alpha-only，保存时强制覆盖。",
        benchmark: "基准",
        rebalance: "调仓频率",
        rebalanceDaily: "每日",
        rebalanceWeekly: "每周",
        rebalanceMonthly: "每月",
        rebalanceQuarterly: "每季",
        weights: "主题权重",
        themesTitle: "主题篮子配置",
        themesEmpty: "暂无主题，请先添加",
        themeKey: "主题代码",
        themeLabel: "主题名称",
        themeWeight: "主题权重",
        themePriority: "主题优先级",
        themeKeywords: "关键词（用于筛选，逗号分隔）",
        themeManual: "手动成分（逗号分隔）",
        themeManualShort: "手动成分",
        themeExclude: "排除成分（逗号分隔）",
        themeExcludeShort: "排除成分",
        themeAdd: "添加主题",
        themeRemove: "删除主题",
        themeHint:
          "关键词用于 Yahoo 搜索；手动成分强制纳入；排除优先级最高（自动/手动都会被移除）；重复成分按优先级归属。",
        themeSystem: "系统主题",
        systemThemeTitle: "系统主题库",
        systemThemeMeta: "权威来源的主题篮子，可直接导入项目",
        systemThemeLabel: "主题名称",
        systemThemeSource: "来源",
        systemThemeVersion: "最新版本",
        systemThemeMode: "导入模式",
        systemThemeWeight: "权重",
        systemThemeActions: "操作",
        systemThemeImport: "导入",
        systemThemeReimport: "更新绑定",
        systemThemeRefresh: "更新来源",
        systemThemeEmpty: "暂无系统主题",
        systemThemeError: "系统主题加载失败",
        systemThemeImported: "系统主题已导入并保存",
        systemThemeImportError: "系统主题导入失败",
        systemThemeRefreshSuccess: "系统主题已更新",
        systemThemeRefreshError: "系统主题更新失败",
        systemThemeModeFollow: "跟随更新",
        systemThemeModePin: "固定版本",
        systemThemeModeSnapshot: "快照导入",
        systemThemeReportTitle: "影响报告",
        systemThemeReportMeta: "系统主题更新对项目的影响摘要",
        systemThemeReportEmpty: "暂无影响报告",
        systemThemeReportVersion: "版本变化",
        systemThemeReportDiff: "变更摘要",
        systemThemeReportTime: "生成时间",
        systemThemeReportActions: "操作",
        systemThemeReportExpand: "展开",
        systemThemeReportCollapse: "收起",
        systemThemeReportNone: "无变化",
        systemThemeDiffSymbols: "成分",
        systemThemeDiffKeywords: "关键词",
        systemThemeDiffManual: "手动",
        systemThemeDiffExclude: "排除",
        themeDuplicate: "主题编码重复，请修改后再保存",
        themeActions: "操作",
        themeCount: "主题数量",
        themeSummaryError: "主题构成读取失败",
        themeTotalSymbols: "覆盖成分数",
        themeComposition: "主题构成",
        themeSymbolCount: "成分数量",
        themeSample: "样例成分",
        themeDistribution: "主题分布",
        themeWeightDistribution: "权重分布",
        themeExpand: "展开",
        themeCollapse: "收起",
        themeEmptySymbols: "暂无股票",
        themeView: "查看详情",
        themeClose: "收起详情",
        themeFilter: "主题过滤",
        themeFilterPlaceholder: "按主题名称或编码筛选",
        themeSearchSymbol: "成分筛选",
        themeSearchPlaceholder: "输入证券代码（如 AAPL）",
        themeSearchHint: "按成分筛选主题",
        themeSearchClear: "清除筛选",
        themeSearchEmpty: "请输入证券代码后再筛选",
        themeSearchError: "股票筛选失败",
        themeSearchMatches: "匹配主题 {count} 个",
        themeDetailTitle: "主题详情 · {name}",
        themeDetailMeta: "共 {total} 只成分（手动 {manual} · 排除 {excluded}）",
        themeDetailFilter: "筛选主题内成分（支持代码包含）",
        themeDetailClear: "清除",
        themeDetailExport: "导出列表",
        themeDetailAuto: "自动成分",
        themeDetailManual: "手动成分",
        themeDetailExcluded: "排除成分",
        themeSymbolPlaceholder: "输入股票代码",
        themeSymbolAdd: "加入主题",
        themeSymbolExclude: "从主题中排除",
        themeSymbolExcludeAction: "排除",
        themeSymbolRemove: "移除",
        themeSymbolRestore: "恢复",
        themeSymbolEmpty: "请输入股票代码",
        themeCompareTitle: "主题对比",
        themeCompareA: "主题 A",
        themeCompareB: "主题 B",
        themeCompareEmpty: "请选择主题",
        themeCompareShared: "交集",
        themeCompareOnlyA: "仅主题 A",
        themeCompareOnlyB: "仅主题 B",
        themeCompareError: "主题对比加载失败",
        includeHistory: "包含历史成分",
        assetTypes: "资产类型过滤",
        assetTypesHint: "为空表示不限制；建议仅保留 Stock 以避免 ETF/ADR 混入。",
        assetTypesLockedHint: "已锁定为 Stock，仅普通股参与训练与回测。",
        pitUniverseOnly: "仅使用 PIT 周度快照股票池",
        pitUniverseOnlyHint: "只从 PIT 周度快照中选股，避免 not_in_pit 过滤。",
        riskFreeRate: "无风险利率",
        backtestStart: "回测起始日期",
        backtestEnd: "回测结束日期",
        backtestRangeHint: "留空表示使用全量历史区间。",
        backtestRangeTitle: "回测区间",
        backtestRangeMeta: "设置回测起止日期，影响下一次回测。",
        sectionUniverse: "成分范围",
        sectionData: "数据源",
        sectionThemes: "主题",
        sectionPortfolio: "组合",
        themeMovedHint: "主题管理已迁移到「主题」页面",
        weightTotal: "权重合计",
        source: "配置来源",
        save: "保存配置",
        saved: "配置已保存",
        error: "保存失败，请检查配置",
      },
      dataStatus: {
        title: "数据状态",
        meta: "S&P500 历史成分与主题数据概况",
        membership: "历史成分数量",
        range: "历史区间",
        universe: "联合成分数量",
        themes: "主题类别数",
        metrics: "指标快照数量",
        prices: "价格文件数量",
        backtestLog: "回测日志路径",
        backtestOutput: "回测输出目录",
        backtestArtifact: "回测归档目录",
        root: "数据根目录",
        action: "刷新数据",
        queued: "已提交数据刷新任务",
        error: "刷新失败，请检查日志",
      },
      algorithm: {
        title: "算法绑定",
        meta: "选择项目使用的算法版本",
        algorithm: "算法",
        version: "算法版本",
        selectAlgorithm: "选择算法",
        selectVersion: "选择版本",
        lock: "锁定算法版本",
        current: "当前绑定",
        summaryTitle: "算法版本摘要",
        summaryMeta: "查看当前版本的关键信息",
        summaryCurrent: "当前版本",
        summaryVersionId: "版本ID",
        summaryType: "算法类型",
        summaryLanguage: "语言",
        summaryPath: "代码路径",
        summaryParams: "参数数量",
        summaryEmpty: "尚未选择算法版本",
        summaryError: "算法版本信息加载失败",
        openLibrary: "进入算法库",
        openLibrarySummary: "算法库/模型版本摘要",
        save: "保存绑定",
        saved: "算法绑定已保存",
        error: "算法绑定失败",
        errorSelect: "请选择算法与版本",
      },
    strategy: {
      title: "策略来源",
      meta: "选择主题权重 / 基线因子 / ML 分数作为评分来源",
        source: "评分来源",
        sourceTheme: "主题权重",
        sourceFactor: "基线因子",
        sourceMl: "ML 分数",
        scorePath: "评分文件",
        scorePathHint: "例如 ml/models/factor_scores.csv",
        scoreTopN: "TopN",
        scoreWeighting: "权重方式",
        weightScore: "按分数",
        weightEqual: "等权",
        scoreMin: "最低分",
        scoreMaxWeight: "最大权重",
        scoreFallback: "缺失回退",
        fallbackTheme: "回退主题权重",
        fallbackUniverse: "回退全量",
        fallbackSkip: "跳过",
        themeHint: "主题权重模式无需评分文件",
        save: "保存策略",
      },
      factorScores: {
        title: "基线因子打分",
        meta: "基于 PIT 周度快照生成基线因子评分",
        start: "开始日期",
        startHint: "例如 2024-01-01",
        end: "结束日期",
        endHint: "例如 2024-03-31",
        config: "因子配置",
        configHint: "默认 configs/factor_scores.json",
        output: "输出路径",
        outputHint: "默认 ml/models/factor_scores.csv",
        overwrite: "清空缓存后重新计算",
        action: "生成评分",
        queued: "评分任务已提交",
        error: "评分任务失败",
        empty: "暂无任务记录",
        latest: "最新任务",
        scoresPath: "评分文件",
        logPath: "日志路径",
        table: {
          id: "任务 ID",
          status: "状态",
          createdAt: "创建时间",
        },
        status: {
          queued: "排队中",
          running: "运行中",
          success: "成功",
          failed: "失败",
          unknown: "未知",
        },
      },
      ml: {
        title: "模型训练",
        meta: "基于当前项目成分重新训练并生成评分",
        symbolCount: "训练覆盖股票",
        benchmark: "训练基准",
        current: "当前模型",
        currentJob: "训练 #{id}",
        device: "训练设备",
        deviceAuto: "自动",
        deviceCpu: "CPU",
        deviceCuda: "GPU",
        modelType: "模型类型",
        modelTypeTorch: "Torch MLP",
        modelTypeLgbm: "LightGBM 排序",
        modelTypeHint: "LightGBM 需额外依赖，未安装时训练会失败。",
        symbolSource: "训练标的来源",
        symbolSourceHint: "可选择项目主题或系统主题作为训练标的集。",
        symbolSourceProject: "项目主题并集",
        symbolSourceProjectShort: "项目",
        symbolSourceSystem: "系统主题",
        symbolSourceSystemShort: "系统",
        systemTheme: "系统主题",
        systemThemeHint: "用于训练标的覆盖（如 DATA_COMPLETE）。",
        systemThemeError: "系统主题加载失败",
        systemThemeRequired: "请选择系统主题",
        trainYears: "训练年限",
        trainStartYear: "训练起始年份",
        trainStartYearPlaceholder: "例如 2010",
        trainStartYearHint: "可为空，最早建议 2000（基于 1999-11 数据 + 252 日暖机）。",
        validMonths: "验证月份",
        walkForward: "滚动训练",
        walkForwardHint: "启用后按训练/验证/测试窗口滚动生成评分。",
        testMonths: "测试月份",
        stepMonths: "步长(月)",
        horizonDays: "预测期(天)",
        lgbm: {
          learningRate: "学习率",
          learningRateHint: "默认 0.05，可根据训练稳定性调整。",
          numLeaves: "叶子数",
          numLeavesHint: "默认 31，数值越大模型越复杂。",
          minDataInLeaf: "叶子最小样本",
          minDataInLeafHint: "默认 50，用于抑制过拟合。",
          estimators: "迭代次数",
          estimatorsHint: "默认 200。",
          subsample: "子采样比例",
          subsampleHint: "默认 0.8，降低过拟合风险。",
          colsampleBytree: "列采样比例",
          colsampleBytreeHint: "默认 0.8，降低过拟合风险。",
        },
        sampleWeighting: "样本权重",
        sampleWeightingHint:
          "市值优先用 PIT 快照，成交额=raw close×raw volume；用于训练样本加权。",
        sampleWeightingNone: "不加权",
        sampleWeightingDollarVolume: "成交额",
        sampleWeightingMarketCap: "市值",
        sampleWeightingMix: "市值+成交额(加权和)",
        sampleWeightAlpha: "市值权重 α",
        sampleWeightAlphaHint: "α 越大越偏向市值(0-1)。",
        sampleWeightDvWindow: "成交额窗口(天)",
        sampleWeightDvWindowHint: "用于计算滚动成交额均值。",
        pitMissingPolicy: "PIT 缺失策略",
        pitMissingPolicyFillZero: "缺失填 0",
        pitMissingPolicyDrop: "缺失丢弃样本",
        pitMissingPolicyHint: "控制 PIT 缺失时的样本处理方式。",
        pitSampleOnSnapshot: "仅快照日采样",
        pitSampleOnSnapshotHint: "仅在 PIT 快照日保留样本，避免插值偏差。",
        pitMinCoverage: "PIT 最低覆盖率",
        pitMinCoverageHint: "低于阈值将触发警告或失败（见后端策略）。",
        modelParams: "高级参数(JSON)",
        modelParamsPlaceholder: "例如 {\"learning_rate\": 0.04, \"num_leaves\": 63}",
        modelParamsHint: "可选，覆盖上方显式参数。",
        modelParamsError: "模型参数 JSON 无法解析",
        train: "重新训练",
        cancel: "停止训练",
        canceling: "取消中",
        queued: "训练任务已提交",
        cancelRequested: "已发起取消",
        cancelError: "取消失败",
        activated: "已设为当前模型",
        activateError: "激活失败",
        error: "训练任务失败",
        active: "当前",
        detail: "详情",
        activate: "设为当前",
        empty: "暂无训练记录",
        detailTitle: "训练详情",
        detailStatus: "状态",
        detailModel: "模型类型",
        detailProgress: "训练进度",
        detailPhase: "当前阶段",
        detailWindow: "训练窗口",
        detailEpoch: "训练轮次",
        detailOutput: "输出目录",
        detailScores: "评分文件",
        detailLog: "训练日志",
        detailConfig: "训练参数",
        detailMessage: "失败原因",
        detailMetric: "指标名称",
        detailBestScore: "最佳指标",
        detailQualityScore: "训练质量评分",
        detailCurveGap: "曲线间隙(训-验)",
        detailBestLoss: "最佳损失",
        detailBestIteration: "最佳迭代",
        detailNdcg10: "NDCG@10(均值)",
        detailNdcg50: "NDCG@50(均值)",
        detailNdcg100: "NDCG@100(均值)",
        detailIc: "IC(均值)",
        detailRankIc: "RankIC(均值)",
        metricCurveTitle: "训练曲线",
        metricCurveMetric: "指标：{metric}",
        metricCurveTrain: "训练",
        metricCurveValid: "验证",
        metricCurveValidScaled: "验证（放大）",
        metricCurveBest: "验证最佳 {value} · 第{iteration}轮",
        metricCurveEmpty: "暂无训练曲线",
        sweep: {
          title: "单参数微调",
          meta: "指定单一参数范围批量发起训练任务",
          paramKey: "参数名",
          paramKeyPlaceholder: "例如 learning_rate",
          paramHint:
            "可用参数（LGBM）：learning_rate / num_leaves / min_data_in_leaf / n_estimators / subsample / colsample_bytree / rank_label_bins",
          start: "起始值",
          end: "结束值",
          step: "步长",
          stepHint: "支持小数步长，例如 0.005",
          includeEnd: "包含结束值",
          preview: "将创建 {count} 个任务：{values}",
          backtestPreset: "回测预设：{preset}",
          action: "批量训练",
          paramRequired: "请填写参数名",
          pipelineRequired: "请先选择或自动创建流水线",
          rangeError: "参数范围无效，请检查起止和步长",
          rangeOrderError: "起始值不能大于结束值",
          stepError: "步长必须大于 0",
          tooMany: "参数数量过多，请缩小范围（最多 {limit} 个）",
          backtestMismatch: "当前回测预设为 {preset}，请切换为 E35 后再执行",
          progress: "已提交 {current}/{total}",
          queued: "已提交 {count} 个训练任务",
          error: "批量训练失败",
          summaryTitle: "微调结果",
          summaryParam: "微调参数",
          summaryRange: "范围/步长",
          best: "最佳结论",
          bestScore: "训练评分 {score}",
          bestBadge: "最佳",
        },
        table: {
          id: "训练ID",
          status: "状态",
          progress: "进度",
          window: "窗口",
          range: "训练/验证/测试范围",
          trainRange: "训练",
          trainRangeShort: "训",
          validRange: "验证",
          validRangeShort: "验",
          testRange: "测试",
          testRangeShort: "测",
          model: "模型",
          horizon: "预测期",
          symbols: "覆盖",
          device: "设备",
          createdAt: "创建时间",
          actions: "操作",
        },
        status: {
          queued: "排队中",
          running: "训练中",
          cancel_requested: "取消中",
          canceled: "已取消",
          success: "成功",
          failed: "失败",
          unknown: "未知",
        },
      },
      decision: {
        title: "当日模型决策",
        meta: "基于最新 PIT 快照与评分生成当日选股结果",
        trainJob: "使用训练模型",
        trainJobAuto: "自动（当前激活模型）",
        trainJobHint: "当前模型 #{id}",
        snapshotDate: "快照日期",
        snapshotHint: "留空则使用最新可用快照",
        preview: "预览决策",
        run: "生成快照",
        empty: "暂无决策快照",
        source: "来源",
        status: "状态",
        sourcePreview: "预览结果",
        sourceLatest: "最新快照",
        asOf: "数据截止",
        scoreDate: "评分日期",
        activeCount: "可交易标的",
        selectedCount: "入选数量",
        filteredCount: "过滤数量",
        riskOff: "风险门控",
        riskOffReason: "风控原因",
        cashWeight: "现金占比",
        maxExposure: "最大敞口",
        scorePath: "评分文件",
        filterStats: "过滤原因分布",
        tabSelected: "入选",
        tabFiltered: "被过滤",
        loadError: "决策快照加载失败",
        previewReady: "预览已生成",
        previewError: "预览失败",
        runQueued: "已发起决策快照生成",
        runError: "发起快照失败",
        table: {
          rank: "排名",
          symbol: "标的",
          score: "评分",
          weight: "权重",
          theme: "主题",
          reason: "过滤原因",
          empty: "暂无结果",
        },
      },
      pipeline: {
        title: "训练/回测流水线",
        meta: "将训练质量评分与回测结果联动排序",
        link: "关联流水线",
        linkNone: "不关联",
        linkHint: "可将训练与回测归档到同一流水线",
        autoCreate: "训练时自动创建流水线",
        name: "流水线名称",
        nameHint: "可选，例如 8Y-LGBM-2024Q4",
        notes: "备注",
        notesHint: "可选，例如参数变化说明",
        sort: "排序方式",
        sortIdDesc: "ID(降序)",
        sortCombined: "综合评分(高→低)",
        sortTrain: "训练评分(高→低)",
        sortBacktest: "回测评分(高→低)",
        sortCreated: "创建时间(早→晚)",
        current: "当前流水线",
        none: "未选择",
        create: "创建流水线",
        created: "流水线已创建",
        error: "流水线操作失败",
        untitled: "未命名",
        active: "当前",
        detail: "详情",
        use: "设为当前",
        empty: "暂无流水线",
        table: {
          id: "ID",
          name: "名称",
          trainScore: "训练评分",
          backtestScore: "回测评分",
          combinedScore: "综合评分",
          trainCount: "训练数",
          backtestCount: "回测数",
          createdAt: "创建时间",
          actions: "操作",
        },
        detailTitle: "流水线详情",
        detailTrainScore: "训练最佳评分",
        detailBacktestScore: "回测最佳评分",
        detailCombinedScore: "综合评分",
        trainListTitle: "训练任务",
        trainTable: {
          id: "ID",
          param: "参数({param})",
          status: "状态",
          quality: "质量评分",
          ndcg10: "NDCG@10",
          ndcg50: "NDCG@50",
          ndcg100: "NDCG@100",
          ic: "IC",
          rankIc: "RankIC",
          curveGap: "曲线间隙",
          createdAt: "创建时间",
          actions: "操作",
          backtest: "以此训练回测",
        },
        trainEmpty: "暂无训练记录",
        backtestListTitle: "回测记录",
        backtestTable: {
          id: "ID",
          trainId: "训练ID",
          status: "状态",
          cagr: "CAGR",
          sharpe: "夏普",
          drawdown: "回撤",
          turnover: "换手率",
          score: "评分",
          createdAt: "创建时间",
        },
        backtestEmpty: "暂无回测记录",
        backtest: {
          title: "回测参数模板",
          meta: "流水线回测默认使用这些参数，可随时手动调整",
          draftStatus: "参数状态",
          draftSaved: "已保存",
          draftDirty: "已修改未保存",
          trainJob: "训练模型",
          trainJobAuto: "自动（不指定）",
          trainJobHint: "指定回测使用的训练任务（关联评分文件）",
          trainJobScorePath: "评分路径：{path}",
          preset: "曝光预设",
          presetHint: "E35/E45 会填充 max_exposure，可继续微调",
          presetE35: "E35（max_exposure=0.35）",
          presetE45: "E45（max_exposure=0.45）",
          presetCustom: "自定义",
          applyE35: "应用E35",
          applyE45: "应用E45",
          target: "编辑对象",
          noTarget: "请先选择流水线",
          save: "保存回测参数",
          saved: "回测参数已保存",
          saveError: "回测参数保存失败",
          runWithSave: "保存并回测",
          runOnce: "仅回测一次",
          runQueued: "回测任务已提交",
          runError: "回测任务提交失败",
          runMissingPipeline: "请先选择流水线",
          runQueuedBatch: "已提交 {count} 个回测任务",
          runNoTrainJobs: "当前流水线没有可回测的训练任务",
          summary: "回测参数",
          empty: "暂无回测参数",
          fields: {
            topN: "TopN",
            weighting: "权重方式",
            maxWeight: "单股上限",
            minScore: "最低分",
            maxExposure: "最大仓位",
            scoreDelay: "分数延迟(日)",
            scoreSmoothingAlpha: "分数平滑系数",
            scoreSmoothingCarry: "缺失评分沿用",
            retainTopN: "持仓缓冲",
            marketFilter: "市场过滤",
            marketMa: "市场均线窗口",
            riskOffMode: "风控模式",
            riskOffPick: "防御筛选",
            riskOffSymbols: "防御篮子",
            riskOffSymbol: "防御资产",
            maxDrawdown: "最大回撤(全程)",
            maxDrawdown52w: "最大回撤(52周)",
            drawdownRecovery: "回撤恢复阈值",
            drawdownExposureFloor: "回撤下限仓位",
            drawdownTiers: "回撤阶梯",
            drawdownExposures: "阶梯仓位",
            maxTurnoverWeek: "周换手上限",
            volTarget: "波动目标",
            volWindow: "波动窗口",
            idleAllocation: "闲置资金停泊",
            dynamicExposure: "动态暴露",
            rebalanceFreq: "调仓频率",
            rebalanceDay: "调仓日",
            rebalanceTime: "调仓时间(分钟)",
          },
          hints: {
            topN: "每次调仓持仓数量",
            weighting: "按分数或等权分配",
            maxWeight: "限制单一标的权重",
            minScore: "低于该值的评分不参与",
            maxExposure: "整体仓位上限（E35/E45 对应 0.35/0.45）",
            scoreDelay: "延后评分日期以避免前视",
            scoreSmoothingAlpha: "EMA 平滑，降低噪声",
            scoreSmoothingCarry: "缺失评分时沿用上一期",
            retainTopN: "超过 TopN 时保留已有持仓",
            marketFilter: "以基准均线过滤风险",
            marketMa: "用于市场过滤的均线窗口",
            riskOffMode: "触发风控后的防御方式",
            riskOffPick: "防御资产选择方式",
            riskOffSymbols: "用于筛选的防御资产池",
            riskOffSymbol: "风控时持有的防御资产",
            maxDrawdown: "触发硬性回撤门控",
            maxDrawdown52w: "近 52 周回撤门控",
            drawdownRecovery: "回撤恢复的阈值比例",
            drawdownExposureFloor: "回撤期最低持仓比例",
            drawdownTiers: "逗号分隔，如 0.08,0.12",
            drawdownExposures: "与回撤阶梯对应的仓位",
            maxTurnoverWeek: "限制周度换手率",
            volTarget: "目标波动率上限",
            volWindow: "波动率估计窗口(天)",
            idleAllocation: "闲置资金配置到防御/基准或空仓",
            dynamicExposure: "按波动目标缩放持仓",
            rebalanceFreq: "日/周/月/季调仓",
            rebalanceDay: "周度调仓的指定日",
            rebalanceTime: "开盘后延时分钟数",
          },
          options: {
            weightingScore: "按分数",
            weightingEqual: "等权",
            riskOffCash: "现金",
            riskOffBenchmark: "基准",
            riskOffDefensive: "防御篮子",
            riskOffPickLowestVol: "最低波动",
            riskOffPickBestMomentum: "最高动量",
            idleNone: "无",
            idleDefensive: "防御资产",
            idleBenchmark: "基准",
            rebalanceDaily: "每日",
            rebalanceWeekly: "每周",
            rebalanceMonthly: "每月",
            rebalanceQuarterly: "每季",
          },
        },
      },
      backtest: {
        title: "项目回测",
        meta: "使用 Lean 引擎运行项目绑定算法",
        defaults: {
          title: "回测默认参数",
          meta: "运行回测时自动应用当前默认参数",
          empty: "暂无默认参数",
          topN: "TopN",
          weighting: "权重方式",
          maxWeight: "单股上限",
          maxExposure: "最大仓位",
          minScore: "最低分",
          marketFilter: "市场过滤",
          marketMa: "市场均线窗口",
          riskOff: "风控模式",
          rebalanceFreq: "调仓频率",
          rebalanceDay: "调仓日",
          rebalanceTime: "调仓时间(分钟)",
          scoreDelay: "分数延迟(日)",
          reloadScores: "刷新评分",
        },
        plugins: {
          title: "策略插件",
          meta: "用于横向对比的回测插件配置",
          scoreDelay: "分数延迟(日)",
          scoreDelayHint: "延后使用评分日期，避免前视",
          scoreSmoothing: "分数平滑",
          scoreSmoothingHint: "EMA 平滑降低噪声",
          scoreSmoothMethod: "平滑方式",
          scoreSmoothEma: "EMA",
          scoreSmoothNone: "无",
          scoreSmoothAlpha: "平滑系数",
          scoreCarry: "沿用缺失评分",
          scoreHysteresis: "持仓缓冲",
          scoreRetain: "保留阈值",
          scoreRetainHint: "大于 TopN 时保留已有持仓",
          weightSmoothing: "权重平滑",
          weightAlpha: "权重平滑系数",
          riskControl: "风险控制",
          riskControlHint: "基于基准均线控制仓位",
          marketMa: "市场均线窗口",
          riskOffMode: "风控模式",
          riskOffCash: "现金",
          riskOffBenchmark: "基准",
          maxExposure: "最大仓位",
          feeBps: "手续费(bps)",
          slippageBps: "滑点(bps)",
          impactBps: "冲击(bps)",
        },
        benchmarkTitle: "基准设置",
        benchmarkMeta: "设置项目回测的对比基准（默认 SPY）",
        action: "运行回测",
        queued: "已提交回测任务",
        empty: "暂无回测结果",
        error: "回测触发失败",
        failed: "回测失败：{message}",
        priceMode: "价格类型",
        benchmarkMode: "基准价格类型",
        pricePolicy: "公司行为口径",
        trainJob: "训练任务",
        scorePath: "评分路径",
        missingScoresTitle: "缺失清单（{count}）",
        priceAdjusted: "复权",
        priceRaw: "原始",
        priceMixed: "混合",
        policyAdjusted: "复权口径",
        policyRaw: "原始口径",
        metric: "指标",
        portfolio: "组合",
        benchmark: "基准",
        metrics: {
          cagr: "年化收益",
          volatility: "波动率",
          sharpe: "夏普比率",
          maxDrawdown: "最大回撤",
        },
      },
      automation: {
        title: "周度自动化",
        meta: "刷新 PIT 周度快照 → 基本面快照 → 主题回测",
        action: "立即执行",
        running: "执行中",
        queued: "自动化任务已排队",
        empty: "暂无自动化记录",
        error: "自动化触发失败",
        statusLabel: "当前状态",
        pitWeekly: "PIT 周度任务",
        pitWeeklyLog: "PIT 周度日志",
        pitFund: "PIT 基本面任务",
        pitFundLog: "PIT 基本面日志",
        backtest: "回测状态",
        backtestLog: "回测日志",
        backtestOutput: "回测输出",
        backtestArtifact: "回测归档",
        log: "自动化日志",
        status: {
          queued: "排队中",
          running: "运行中",
          success: "成功",
          failed: "失败",
          unknown: "未知",
        },
      },
      versions: {
        title: "版本管理",
        meta: "记录项目描述或关键配置快照",
        emptyProject: "暂无项目",
        version: "版本号 (v0.1)",
        description: "版本说明",
        content: "内容快照（默认使用当前项目描述：{description}）",
        errorSelect: "请先选择项目",
        errorContent: "请填写版本号或内容快照",
      },
      diff: {
        title: "版本对比",
        meta: "选择两个版本生成差异",
        selectFrom: "选择旧版本",
        selectTo: "选择新版本",
        errorSelect: "请选择两个版本进行对比",
        empty: "无差异",
        none: "尚未生成 diff",
      },
      versionsTable: {
        id: "版本 ID",
        version: "版本号",
        summary: "摘要",
        hash: "Hash",
        createdAt: "创建时间",
        empty: "暂无版本记录",
        unnamed: "未命名",
      },
    },
    themes: {
      title: "主题管理",
      project: {
        title: "项目选择",
        meta: "选择项目后管理主题结构与权重",
        select: "当前项目",
        name: "项目名称",
        description: "项目描述",
        configSource: "配置来源",
        empty: "请选择项目后继续",
      },
      config: {
        title: "主题配置",
        meta: "维护主题权重、关键词与手动股票",
      },
      composition: {
        title: "主题构成",
        meta: "查看主题覆盖与股票组成",
      },
      compare: {
        meta: "对比主题交集与差集",
      },
    },
    algorithms: {
      title: "算法管理",
      register: {
        title: "登记算法",
        meta: "用于管理策略版本与执行入口",
        name: "算法名称",
        description: "算法说明",
        language: "语言 (Python/CSharp)",
        version: "版本 (v1.0.0)",
        path: "算法文件路径（/app/stocklean/algorithms/xxx.py）",
        typeName: "C# 类型名（可选）",
        errorName: "请输入算法名称",
      },
      overview: {
        title: "算法概览",
        meta: "当前已登记数量",
      },
      list: {
        title: "算法列表",
        meta: "快速筛选与定位算法",
        search: "搜索算法名称",
        empty: "暂无算法",
      },
      detail: {
        title: "算法详情",
        meta: "编辑基础信息与版本统计",
        latest: "最新版本 #{id}",
        versions: "版本数 {count}",
        name: "算法名称",
        description: "算法说明",
        language: "语言",
        version: "默认版本",
        path: "算法路径",
        typeName: "类型名称",
        empty: "请先选择算法",
        error: "保存失败，请稍后重试",
      },
      tabs: {
        params: "参数",
        versions: "版本",
        diff: "对比",
        project: "项目",
        selftest: "自测",
      },
      selftest: {
        title: "算法自测",
        meta: "使用 Lean 运行回测并与基准对比",
        version: "算法版本",
        benchmark: "基准指数/ETF",
        hint: "推荐基准：SPY、QQQ、VTI、IWM、DIA，可自定义输入",
        action: "发起自测",
        running: "自测运行中...",
        queued: "已提交回测，ID {id}",
        lastRun: "最近回测 ID {id}",
        viewReports: "查看报告",
        error: "回测触发失败",
        failed: "回测失败：{message}",
        errorSelect: "请选择算法版本",
      },
      params: {
        title: "算法参数",
        meta: "周度选股与风控配置",
        cadence: "调仓频率",
        weekly: "每周",
        monthly: "每月",
        market: "市场",
        us: "美股",
        assetClass: "资产类型",
        equity: "股票",
        allowEtf: "允许 ETF",
        coreTitle: "核心股票权重",
        coreSymbols: "核心股票（逗号分隔）",
        coreWeight: "核心权重",
        coreFallback: "缺失时处理",
        cash: "持有现金",
        redistribute: "再分配到核心",
        themeTitle: "主题权重",
        themeKey: "主题代码",
        themeWeight: "权重",
        themeAdd: "添加主题权重",
        themeRemove: "移除",
        themeEmpty: "暂无主题权重，请先添加",
        themeOptionHint: "可输入主题编码或从系统主题模板中选择",
        selectionTitle: "筛选参数",
        topN: "每主题入选数量",
        topMomentum: "动量入选数",
        topLowVol: "低波动入选数",
        minPositions: "最小持仓数",
        trendWeeks: "趋势窗口（周）",
        riskOnWeeks: "风险开关均线（周）",
        lowvolDays: "低波动窗口（天）",
        momShortDays: "短动量窗口（天）",
        momLongDays: "长动量窗口（天）",
        mom12w: "12周动量权重",
        mom4w: "4周动量权重",
        vol20d: "20日波动惩罚",
        blendTitle: "动量/低波动混合",
        momentumWeight: "动量权重",
        lowvolWeight: "低波动权重",
        riskTitle: "风控参数",
        maxWeight: "单股上限",
        volTarget: "目标波动",
        drawdown: "最大回撤阈值",
        inverseVol: "逆波动率加权",
        minVol: "最小波动率",
        themeTilt: "主题权重倾斜",
        defensiveTitle: "防御资产",
        defensiveSymbols: "防御资产（逗号分隔）",
        defensiveHint: "风险关闭时将仓位切换到防御资产",
        advancedTitle: "高级参数",
        advancedHint: "用于复合/低波动策略，按需填写",
        coreEnable: "启用核心股票权重",
        coreDisabledHint: "新建算法默认不使用核心权重，可按需开启",
        modeForm: "结构化参数",
        modeJson: "JSON 参数",
        modeHint: "若算法参数与表单不匹配，可切换到 JSON 模式进行通用配置",
        jsonTitle: "参数 JSON",
        jsonPlaceholder: "{\n  \"selection\": {\n    \"top_n\": 20\n  }\n}",
        jsonHint: "保存版本时将以此 JSON 为准",
        jsonError: "参数 JSON 无效，请检查格式",
        notes: "备注",
        reset: "重置",
        saveVersion: "保存为版本",
      },
      table: {
        name: "名称",
        language: "语言",
        version: "版本",
        path: "路径",
        updatedAt: "更新时间",
      },
      versions: {
        title: "版本管理",
        meta: "为算法登记版本快照并生成对比",
        empty: "暂无算法",
        pick: "选择版本",
        version: "版本号 (v1.0.1)",
        description: "版本说明",
        language: "语言（默认 {language}）",
        typeName: "C# 类型名（可选）",
        filePath: "算法文件路径（留空则使用内容）",
        content: "算法内容（可选，用于生成 diff）",
        errorSelect: "请先选择算法",
        errorContent: "请至少填写版本号、文件路径/内容或参数",
      },
      projectCreate: {
        title: "从算法创建项目",
        meta: "将指定版本作为项目模板",
        name: "项目名称",
        description: "项目描述",
        version: "算法版本",
        lock: "锁定版本",
        action: "创建项目",
        success: "项目已创建并绑定算法",
        error: "创建失败，请检查输入",
        errorSelect: "请选择算法版本",
      },
      diff: {
        title: "版本对比",
        meta: "选择两个版本生成差异",
        selectFrom: "选择旧版本",
        selectTo: "选择新版本",
        errorSelect: "请选择两个版本进行对比",
        empty: "无差异",
        none: "尚未生成 diff",
        unnamed: "未命名",
      },
      versionsTable: {
        id: "版本 ID",
        version: "版本号",
        summary: "摘要",
        hash: "Hash",
        createdAt: "创建时间",
        empty: "暂无版本记录",
      },
    },
    backtests: {
      title: "回测中心",
      tabs: {
        runs: "回测",
        reports: "报告",
      },
      actions: {
        viewCharts: "图表",
        viewTrades: "交易",
      },
      launch: {
        title: "发起回测",
        meta: "填写项目 ID 与参数",
        projectId: "项目 ID",
        params: "参数 JSON",
      },
      table: {
        id: "ID",
        project: "项目",
        status: "状态",
        progress: "进度",
        range: "区间",
        report: "报告",
        actions: "操作",
        createdAt: "创建时间",
        endedAt: "结束时间",
      },
      preview: {
        title: "回测图表",
        meta: "点击回测记录即可查看收益与交易图表",
        empty: "请选择回测查看图表",
        charts: "收益与回撤",
        trades: "交易图表",
      },
    },
    reports: {
      title: "报告中心",
      latest: {
        title: "最新报告",
        meta: "回测运行后自动归档",
      },
      preview: {
        title: "报告预览",
        meta: "在页面内查看回测 HTML 报告",
        open: "新窗口打开",
        empty: "请选择报告进行预览",
      },
      risk: {
        title: "公司行为风险提示",
        meta:
          "复权与更名映射依赖 map_files/factor_files。缺失时可能导致历史价格断裂或回测误差。",
      },
      compare: {
        title: "回测对比",
        meta: "输入多个回测 ID，快速横向比较关键指标",
        placeholder: "例如：2, 15, 18",
        error: "对比失败",
        empty: "请输入回测 ID（逗号或空格分隔）",
      },
      charts: {
        title: "图表预览",
        meta: "输入回测 ID，加载收益曲线与回撤曲线",
        placeholder: "回测 ID",
        errorNotFound: "未找到结果文件，请确认回测已完成",
        errorLoad: "读取图表失败",
      },
        trades: {
          title: "交易图表",
          meta: "叠加买卖点与行情走势，快速查看交易细节",
          placeholder: "回测 ID",
          symbolPlaceholder: "股票代码",
          load: "加载交易图表",
          loading: "交易数据加载中...",
          error: "交易图表加载失败",
          empty: "暂无交易数据或缺少行情数据",
          buy: "买入",
          buyShort: "买",
          sell: "卖出",
          sellShort: "卖",
          tradesCount: "{count} 笔",
          summary: "买 {buys} / 卖 {sells} · 胜 {wins} / 负 {losses}",
          table: {
            time: "时间",
            side: "方向",
            qty: "数量",
            price: "价格",
          },
        },
      table: {
        id: "ID",
        runId: "回测 ID",
        type: "类型",
        path: "路径",
        actions: "操作",
        createdAt: "生成时间",
      },
    },
    data: {
      title: "数据管理",
      coverage: {
        title: "数据覆盖",
        meta: "数据层更新与质量监控",
      },
      liveTrade: {
        title: "实盘交易入口",
        meta: "IB 实盘相关配置已迁移到「实盘交易」页面",
        hint: "实盘数据与执行配置请在实盘交易页面集中管理。",
        open: "前往实盘交易",
      },
      lifecycle: {
        title: "生命周期覆盖",
        meta: "当 delist 与价格历史冲突时，可用覆盖文件修正。",
        source: "默认生命周期文件：",
        override: "覆盖文件：",
        priority: "覆盖优先级高于 Alpha 原始生命周期。",
        config: "权重配置可指定：",
      },
      fetch: {
        title: "历史数据抓取",
        meta: "默认 Alpha，当前仅支持日线历史数据。",
        symbol: "股票代码（如 AAPL）",
        vendor: {
          stooq: "Stooq",
          yahoo: "Yahoo",
          alpha: "Alpha Vantage（默认）",
        },
        stooqOnly: "仅限 Alpha",
        region: {
          us: "美股",
          hk: "港股",
        },
        asset: {
          equity: "股票",
          etf: "ETF",
        },
        frequency: {
          daily: "日线",
          minute: "分钟（暂不支持）",
        },
        preview: "将创建数据集 {dataset} · 来源 {source}",
        action: "抓取历史",
        loading: "抓取中",
        hint: "Alpha 仅支持日线，系统会自动发起数据同步任务",
        errorSymbol: "请填写股票代码",
        errorFrequency: "当前数据源仅支持日线数据",
        error: "历史数据抓取失败",
        successCreated: "已创建数据集 {name}，同步任务 #{jobId} 已排队",
        successQueued: "已复用数据集 {name}，同步任务 #{jobId} 已排队",
        successNoJob: "已准备数据集 {name}",
      },
      list: {
        title: "数据集列表",
        meta: "当前筛选 {totalSymbols} 只股票 / {totalDatasets} 个数据集 · 支持日线/分钟",
        stooqOnly: "仅限 Alpha",
        empty: "暂无数据集",
        filter: {
          label: "周期筛选",
          all: "全部",
          daily: "日线",
          minute: "分钟",
        },
        theme: {
          label: "主题",
          all: "全部主题",
          loading: "加载中",
          error: "主题加载失败",
          coverageTitle: "主题覆盖度 · {theme}",
          coverageMeta: "已覆盖 {covered}/{total} · 缺口 {missing}",
          coverageSample: "缺口样例：{symbols}",
          coverageEmpty: "暂无主题覆盖信息",
          coverageError: "主题覆盖读取失败",
          fetch: "补齐主题成分数据",
          fetching: "补齐中",
          fetchSuccess: "已创建 {created} 个数据集，排队 {queued} 个同步任务",
          fetchError: "补齐失败",
          confirm: "将为主题补齐 {count} 只成分数据，是否继续？",
          noMissing: "主题成分已齐全",
        },
        update: {
          sync: "更新",
          syncing: "更新中",
          syncAll: "全部更新",
          syncingAll: "更新中",
          reset: "全量重跑（清空后重抓）",
          resetConfirm: "将清空本地历史数据并重新抓取，是否继续？",
        },
        chart: {
          show: "图表",
          hide: "收起图表",
        },
        delete: {
          action: "删除",
          deleting: "删除中",
          confirm: "将删除 {symbol} 的全部数据，是否继续？",
          prompt: "请输入 {symbol} 以确认删除",
          mismatch: "输入不匹配，已取消删除",
          error: "删除失败",
        },
        quality: {
          loading: "加载中",
          error: "质量异常",
          incomplete: "不完整",
          days: "天",
          issues: "问题 {count}",
        },
        table: {
          symbol: "Symbol",
          name: "名称",
          periods: "周期/区间",
          frequency: "周期",
          coverage: "覆盖区间",
          updatedAt: "更新时间",
          source: "来源",
          quality: "质量",
          update: "更新",
          actions: "操作",
        },
      },
      pretrade: {
        title: "PreTrade 周度检查",
        meta: "周度调仓前的数据同步编排与回退",
        projectSelect: "选择项目",
        projectRequired: "请先选择项目",
        projectLoadError: "项目加载失败",
        templateAuto: "使用当前模板/默认步骤",
        templateNameRequired: "请输入模板名称",
        templateParseError: "模板参数 JSON 解析失败",
        templateLoadError: "模板加载失败",
        templateCreateError: "模板创建失败",
        templateActivateError: "设为当前失败",
        runCreated: "已创建运行 #{id}",
        runLoadError: "运行列表加载失败",
        runDetailError: "运行详情加载失败",
        runCreateError: "创建运行失败",
        runCancelError: "取消运行失败",
        runResumeError: "续跑失败",
        stepRetryError: "步骤重试失败",
        settingsSaved: "已保存设置",
        settingsLoadError: "读取设置失败",
        settingsSaveError: "保存设置失败",
        summaryLine: "运行 #{id} · 状态 {status}",
        summaryProgress: "完成 {done}/{total} · {percent}%",
        summaryDeadline: "截止 {at}",
        summaryWindow: "窗口 {start} ~ {end}",
        summaryFallback: "回退到运行 #{id}",
        summaryEmpty: "暂无运行记录",
        windowStart: "窗口开始日期",
        windowEnd: "窗口结束日期",
        run: {
          title: "发起 Checklist",
          action: "开始运行",
          note: "仅允许单实例执行",
        },
        history: {
          title: "历史运行",
          empty: "暂无历史运行",
          id: "ID",
          status: "状态",
          window: "窗口",
          actions: "操作",
          view: "查看",
          cancel: "取消",
          canceling: "取消中",
          resume: "续跑",
          resuming: "续跑中",
        },
        steps: {
          title: "步骤详情",
          empty: "暂无步骤",
          name: "步骤",
          status: "状态",
          progress: "进度",
          updatedAt: "更新时间",
          message: "信息",
          actions: "操作",
          retry: "重试",
          retrying: "重试中",
          nextRetry: "下次重试 {at}",
          logPath: "日志 {path}",
          calendar_refresh: "交易日历刷新",
          trading_day_check: "交易日校验",
          price_incremental: "价格增量同步",
          listing_refresh: "Listing 刷新",
          fundamentals_refresh: "基本面缓存刷新",
          pit_weekly: "PIT 周度快照",
          pit_fundamentals: "PIT 基本面快照",
          training_scoring: "训练/评分",
          decision_snapshot: "模型决策快照",
          audit: "验收审计",
        },
        stepsDesc: {
          calendar_refresh: "更新交易日历与节假日表",
          trading_day_check: "校验调仓窗口与交易日序列",
          price_incremental: "增量同步历史价格数据",
          listing_refresh: "刷新 Alpha Listing/生命周期信息",
          fundamentals_refresh: "仅刷新 Alpha 基本面缓存（不生成 PIT 快照）",
          pit_weekly: "生成 PIT 周度快照（股票池）",
          pit_fundamentals: "基于 PIT 周度快照 + 基本面缓存生成快照",
          training_scoring: "训练/评分（可选）",
          decision_snapshot: "生成当日模型决策快照",
          audit: "全量数据审计与覆盖检查",
        },
        stepsGroup: {
          data: "数据准备",
          dataHint: "基础行情、Listing 与基本面缓存",
          pit: "PIT 快照",
          pitHint: "依赖：周度快照 + 基本面缓存",
          model: "模型/审计",
          modelHint: "训练、决策快照与审计",
          other: "其他步骤",
          otherHint: "模板包含的扩展步骤",
        },
        settings: {
          title: "通知与重试设置",
          token: "Telegram Bot Token",
          tokenHint: "已配置：{token}",
          chatId: "Telegram Chat ID",
          chatIdHint: "已配置：{chatId}",
          maxRetries: "最大重试次数",
          retryBase: "重试退避基数(秒)",
          retryMax: "最大退避(秒)",
          deadlineTime: "最后完成时间(HH:MM)",
          deadlineTimezone: "时区",
          projectOnly: "仅更新项目相关标的",
          projectOnlyHint: "开启后仅处理激活且未归档项目的成分（含历史行情与基本面）",
          autoDecision: "Checklist 完成后自动生成模型决策快照",
          autoDecisionHint: "开启后在 Checklist 末尾生成当日模型决策快照",
          note: "留空 token/chat_id 不会覆盖已有配置",
        },
        telegram: {
          test: "发送测试通知",
          testMessage: "PreTrade checklist 测试通知",
          testOk: "已发送测试通知",
          testError: "发送失败",
        },
        templates: {
          title: "Checklist 模板",
          id: "ID",
          name: "名称",
          params: "模板参数(JSON)",
          create: "创建模板",
          createError: "创建模板失败",
          activate: "设为当前",
          activating: "设为当前中",
          active: "当前",
          activeTag: "当前",
          actions: "操作",
          hint: "勾选步骤生成模板；仅在需要时使用高级 JSON 覆盖",
          editing: "正在编辑模板 #{id}",
          stepsTitle: "步骤选择",
          selectAll: "全选",
          clearAll: "全不选",
          reset: "恢复默认",
          useAdvanced: "使用高级 JSON 覆盖步骤",
          advancedHint: "启用后以高级 JSON 为准；关闭则使用步骤选择",
          preview: "参数预览",
          update: "保存更新",
          cancelEdit: "取消编辑",
          details: "详情",
          edit: "载入编辑",
          stepsSummary: "步骤概览",
          stepsCount: "启用 {enabled}/{total}",
          detailTitle: "模板详情 #{id}",
          paramsPreview: "参数 JSON",
          noSteps: "无步骤",
          delete: "删除",
          deleteConfirm: "确认删除该模板？删除后无法恢复。",
          deleteError: "删除模板失败",
          empty: "暂无模板",
        },
      },
      bulk: {
        title: "全量抓取（全美股）",
        meta: "基于 Alpha listing 分批建档并入队",
        autoTitle: "一键自动：刷新列表 → 建档入队 → 自动抓取",
        autoAction: "开始一键全量抓取",
        autoLoading: "自动抓取启动中",
        autoHint: "会先刷新全美股 listing，再自动分批建档并启动队列",
        autoNote: "后台可自动续跑，刷新页面可查看进度",
        autoStatus: "任务 #{id} · 状态 {status} · 阶段 {phase}",
        autoCounts: "已建档 {created} · 复用 {reused} · 入队 {queued} · 运行 {running} · 待处理 {pending}",
        auto: {
          batch: "自动批次大小（如 200）",
          delay: "抓取间隔秒（如 0.1）",
        },
        gap: {
          title: "Alpha 覆盖缺口概览",
          latestComplete: "最新交易日 {date}",
          total: "总标的 {count}",
          withCoverage: "有覆盖 {count}",
          missingCoverage: "缺覆盖 {count}",
          upToDate: "已最新 {count}",
          bucket0_30: "缺口 0-30 天 {count}",
          bucket31_120: "缺口 31-120 天 {count}",
          bucket120Plus: "缺口 120+ 天 {count}",
          listingAge: "listing 刷新距今 {days} 天",
          loadError: "覆盖缺口统计失败",
        },
        listing: {
          title: "Listing 刷新策略",
          modeAlways: "每次刷新",
          modeStale: "过期才刷新",
          modeNever: "不刷新",
          ttlDays: "过期阈值（天）",
          hint: "该策略仅影响本次全量抓取的 listing 刷新",
        },
        incremental: {
          title: "增量抓取策略（全局）",
          enabled: "启用增量抓取",
          compactDays: "compact 阈值天数（如 120）",
          hint: "缺口天数 ≤ 阈值时使用 compact，超过则 full",
          note: "全局生效，单标的与全量抓取均遵循此策略",
          saved: "已保存增量策略",
          loadError: "读取增量策略失败",
          saveError: "保存增量策略失败",
        },
        defaults: {
          note: "保存全量抓取默认策略（含 listing 与增量）",
          saved: "已保存全量抓取默认策略",
          loadError: "读取全量抓取默认策略失败",
          saveError: "保存全量抓取默认策略失败",
        },
        autoError: "自动全量抓取状态读取失败",
        actionError: "操作失败",
        errorDetail: "错误：{detail}",
        statusLabel: {
          queued: "排队",
          running: "运行中",
          paused: "已暂停",
          success: "完成",
          failed: "失败",
          canceled: "已取消",
        },
        phaseLabel: {
          listing_refresh: "刷新列表",
          enqueue: "建档入队",
          syncing: "抓取中",
          done: "完成",
          canceled: "已取消",
          paused: "已暂停",
        },
        actions: {
          pause: "暂停",
          resume: "继续",
          cancel: "取消",
        },
        history: {
          title: "历史任务",
          empty: "暂无历史任务",
          id: "ID",
          status: "状态",
          phase: "阶段",
          progress: "进度",
          counts: "统计",
          error: "错误",
          updatedAt: "更新时间",
          actions: "操作",
          progressValue: "{processed}/{total}",
          countsValue: "建档 {created} · 复用 {reused} · 入队 {queued}",
        },
        step1: "步骤 1：分批建档并入队（不会自动开始抓取）",
        step2: "步骤 2：启动队列开始抓取",
        status: {
          all: "全部",
          active: "仅在市",
          delisted: "仅退市",
        },
        limit: "批次大小（如 200）",
        offset: "起始偏移（如 0）",
        batchHint: "批次大小=每次处理数量；偏移=从第 N 只开始",
        offsetHint: "按“下一批”连续执行，避免重复",
        onlyMissing: "仅创建缺失数据集",
        projectOnly: "仅抓取项目相关标的",
        projectOnlyHint: "开启后仅处理激活且未归档项目的成分",
        autoSync: "创建后自动入队同步任务",
        action: "创建并入队",
        loading: "处理中",
        hint: "建议分批执行，完成后用下方队列启动抓取",
        result: "已创建 {created} · 复用 {reused} · 入队 {queued} · 总量 {total} · 下一批 {next}",
        progress: "进度 {processed}/{total}（{percent}%）",
        applyNext: "填入下一批偏移（{next}）",
        error: "全量抓取任务创建失败",
        queueError: "队列启动失败",
        queue: {
          maxJobs: "本次执行任务数（0 为全部）",
          minDelay: "任务间隔秒（如 0.1）",
          hint: "队列按间隔顺序执行，速度受限速与网络影响",
          action: "启动队列",
          loading: "队列启动中",
          result: "{started} · 待处理 {pending}",
          started: "队列已启动",
          already: "队列已在运行",
        },
      },
      pit: {
        title: "PIT 周度快照",
        meta: "周一开盘调仓，快照取上一个交易日收盘",
        start: "开始日期",
        end: "结束日期",
        requireData: "仅包含已抓取行情的股票",
        action: "生成周度快照",
        loading: "生成中",
        note: "输出到 universe/pit_weekly，可用于周度调仓回测",
        latest: "最近任务 #{id} · 状态 {status}",
        calendar: "交易时区 {tz} · 时段 {session}",
        qualityError: "质量报告读取失败",
        progressError: "进度读取失败",
        quality: {
          snapshots: "快照 {count}",
          symbols: "样本 {count}",
          fixed: "修正 {count}",
          dup: "重复 {count}",
          invalid: "无效 {count}",
          mismatch: "日期异常 {count}",
          life: "生命周期异常 {count}",
          noData: "无数据 {count}",
          updated: "更新 {at}",
        },
        progress: {
          stage: "阶段 {stage}",
          status: "状态 {status}",
          count: "快照 {count}",
          updated: "更新 {at}",
        },
        snapshotCount: "快照数 {count}",
        lastSnapshot: "最新快照 {path}",
        output: "输出 {path}",
        log: "日志 {path}",
        historyTitle: "最近任务",
        historyEmpty: "暂无任务",
        loadError: "周度快照任务读取失败",
        error: "周度快照任务创建失败",
        created: "已创建任务 #{id}",
        history: {
          id: "ID",
          status: "状态",
          count: "快照数",
        },
      },
      pitFund: {
        title: "PIT 基本面快照",
        meta: "分离基本面缓存获取与 PIT 周度快照生成",
        start: "开始日期",
        end: "结束日期",
        startHint: "仅处理该日期之后的 PIT 周度快照",
        endHint: "仅处理该日期之前的 PIT 周度快照",
        cacheSectionTitle: "基本面缓存获取",
        cacheSectionHint: "仅刷新 Alpha 基本面缓存，不生成 PIT 快照",
        delay: "披露延迟（日）",
        delayHint: "快照日期向前回退的交易日数量",
        missingDelay: "缺失披露延迟（日）",
        missingDelayHint: "reportedDate 缺失时使用 fiscalDate + 默认延迟（如 45 天）",
        sharesDelay: "股本可用延迟（日）",
        sharesDelayHint: "SHARES_OUTSTANDING 无披露日时的保守延迟",
        sharesPreference: "股本口径",
        sharesPreferenceHint: "选择 diluted 或 basic",
        sharesPreferenceDiluted: "稀释股本 (diluted)",
        sharesPreferenceBasic: "基本股本 (basic)",
        priceSource: "价格口径",
        priceSourceHint: "用于 PIT 市值的价格来源",
        priceSourceRaw: "原始价格 (curated)",
        priceSourceAdjusted: "复权价格 (curated_adjusted)",
        minDelay: "抓取间隔（秒）",
        minDelayHint: "每次请求间隔，越小越快但更容易触发限速",
        refreshDays: "缓存刷新天数（0=强制刷新）",
        refreshDaysHint: "0 表示每次都重新拉取，忽略缓存更新时间",
        assetTypes: "资产类型过滤",
        assetTypesHint: "逗号分隔，如 STOCK；留空或 ALL 表示不过滤",
        cacheAction: "刷新基本面缓存",
        cacheLoading: "刷新中",
        cacheNote: "输出到 fundamentals/alpha",
        snapshotSectionTitle: "PIT 基本面快照",
        snapshotSectionHint: "基于缓存生成 PIT 周度基本面快照",
        projectOnly: "仅抓取项目相关标的",
        projectOnlyHint: "开启后仅抓取激活且未归档项目的成分",
        resume: "断点续跑",
        resumeHint: "自动跳过已完整缓存的标的",
        action: "生成基本面快照",
        loading: "生成中",
        note: "输出到 factors/pit_weekly_fundamentals",
        latest: "最近任务 #{id} · 状态 {status}",
        latestMode: "模式 {mode}",
        progressError: "进度读取失败",
        mode: {
          cache: "缓存",
          snapshot: "快照",
          both: "缓存+快照",
          none: "未设置",
        },
        progress: {
          stage: "阶段 {stage}",
          count: "进度 {done}/{total}",
          ok: "成功 {count}",
          partial: "异常 {count}",
          rate: "限流重试 {count}",
          speed: "速度 {rate}/min · 目标 {target}/min · 间隔 {interval}s",
          tune: "自动微调 {reason} → {delay}s",
          current: "当前 {symbol}",
          missing: "缺失 {count}",
          missingPath: "清单 {path}",
        },
        snapshotCount: "快照数 {count}",
        lastSnapshot: "最新快照 {path}",
        output: "输出 {path}",
        log: "日志 {path}",
        historyTitle: "最近任务",
        historyEmpty: "暂无任务",
        loadError: "基本面快照任务读取失败",
        error: "基本面快照任务创建失败",
        created: "已创建任务 #{id}",
        cacheCreated: "已创建缓存任务 #{id}",
        resumed: "已创建续跑任务 #{id}",
        resumeError: "断点续跑失败",
        canceled: "已请求停止任务 #{id}",
        cancelError: "停止任务失败",
        history: {
          id: "ID",
          status: "状态",
          mode: "类型",
          count: "快照数",
          progress: "进度",
          actions: "操作",
          resume: "断点续跑",
          stop: "停止",
          canceling: "取消中",
        },
      },
      frequency: {
        daily: "日线",
        minute: "分钟",
      },
      chart: {
        title: "股票图表",
        meta: "K线与复权对比 · {frequency} · {coverage}",
        mode: {
          both: "对比",
          raw: "原始价格",
          adjusted: "复权价格",
        },
        granularity: {
          auto: "自动",
          day: "日",
          week: "周",
          month: "月",
        },
        range: {
          max: "全部",
        },
        open: "新窗口打开",
        legend: {
          raw: "实际价格（K线）",
          adjusted: "复权价格（折线）",
        },
        loading: "图表加载中...",
        empty: "暂无图表数据",
        error: "图表加载失败",
      },
      table: {
        name: "名称",
        vendor: "供应商",
        frequency: "频率",
        coverage: "覆盖区间",
        path: "路径",
        quality: "质量",
        updatedAt: "更新时间",
      },
      quality: {
        error: "获取质量报告失败",
        title: "质量报告",
        status: "状态",
        coverage: "覆盖区间",
        days: "覆盖天数",
        frequency: "频率",
        expected: "预计数据点",
        points: "数据点",
        minInterval: "最小间隔(天)",
        issues: "问题",
      },
      scan: {
        title: "质量扫描（缺失/异常）",
        meta: "输入 CSV 路径并执行扫描",
        select: "选择数据集",
        errorSelect: "请选择数据集",
        filePath: "CSV 文件路径（位于 DATA_ROOT 内）",
        errorFilePath: "请输入数据文件路径",
        dateColumn: "日期列名",
        closeColumn: "收盘价列名",
        frequency: "频率覆盖 (daily/minute)",
        error: "质量扫描失败",
        result: "扫描结果",
        totalRows: "总行数",
        missingDays: "缺失交易日",
        missingRatio: "缺失比例",
        nullClose: "空收盘价记录",
        duplicate: "重复时间戳",
        outliers: "异常收益数",
        maxAbs: "最大绝对收益",
      },
      sync: {
        title: "数据更新（补齐/增量）",
        meta: "扫描路径并更新覆盖区间",
        path: "数据路径（可留空，或 alpha:SYMBOL）",
        dateColumn: "日期列名",
        errorCreate: "更新任务创建失败",
        errorBatch: "批量更新失败",
        incrementalHint: "Alpha 同步策略：{mode} · compact 阈值 {days} 天",
        incremental: {
          enabled: "增量",
          disabled: "全量",
        },
      },
      jobs: {
        title: "更新任务",
        meta: "共 {total} 条同步任务",
        speed:
          "实际 {rate}/min · 目标 {target}/min · 间隔 {interval}s · 最近 {window}s · 运行 {running} · 待处理 {pending}",
        speedEmpty: "速度 -",
        clear: "清理队列",
        clearing: "清理中",
        clearConfirm: "确认清理队列中待处理任务？运行中的任务会继续执行。",
        clearDone: "已清理 {count} 条待处理任务",
        clearError: "清理队列失败",
        empty: "暂无更新任务",
        retry: "重试 {count} 次 · 下次 {next}",
        elapsed: "耗时 {value}",
        stage: "阶段 {stage}",
        stageProgress: "阶段 {stage} · {progress}%",
        id: "ID",
        dataset: "数据集",
        status: "状态",
        rows: "扫描行数",
        coverage: "覆盖区间",
        outputs: "输出/归档",
        message: "消息",
        createdAt: "创建时间",
        reason: {
          stooqOnly: "仅 {vendor}",
          rateLimited: "限流",
          premium: "需付费",
          notFound: "未覆盖",
          failed: "失败",
        },
        outputLabels: {
          curated: "curated",
          normalized: "normalized",
          adjusted: "adjusted",
          snapshot: "snapshot",
          lean: "lean",
          leanAdjusted: "lean(adj)",
        },
        alpha: {
          outputsize: "alpha={value}",
          gapDays: "gap {value}d",
          fallback: "compact 回退",
        },
        stageLabel: {
          fetch: "抓取",
          normalize: "归一化",
          finalize: "收尾",
        },
      },
      alphaRate: {
        title: "Alpha 限速配置",
        meta: "控制 Alpha 请求速率与自动微调 · 配置 {path}",
        baseTitle: "基础限速",
        tuneTitle: "自动微调参数",
        maxRpm: "最大 RPM",
        maxRpmHint: "目标每分钟请求数 (max_rpm)",
        minDelay: "最小间隔(秒)",
        minDelayHint: "基础间隔，实际间隔会与 max_rpm 自动取最大值",
        rateLimitSleep: "限速休眠(秒)",
        rateLimitSleepHint: "触发限速时的等待时间",
        rateLimitRetries: "限速重试次数",
        rateLimitRetriesHint: "限速后同一标的重试次数",
        maxRetries: "最大重试次数",
        maxRetriesHint: "单接口失败重试次数",
        autoTune: "自动微调",
        autoTuneHint: "根据实际速度自动调整 min_delay",
        rpmFloor: "RPM 下限",
        rpmFloorHint: "触发限速时不会低于该 RPM",
        rpmCeil: "RPM 上限",
        rpmCeilHint: "回升时最多恢复到该 RPM",
        rpmStepDown: "限速降幅",
        rpmStepDownHint: "触发限速时每次降低的 RPM",
        rpmStepUp: "回升步长",
        rpmStepUpHint: "低于目标速率时的 RPM 回升幅度",
        minDelayFloor: "间隔下限(秒)",
        minDelayFloorHint: "自动微调的最小间隔",
        minDelayCeil: "间隔上限(秒)",
        minDelayCeilHint: "自动微调的最大间隔",
        tuneStep: "微调步长(秒)",
        tuneStepHint: "每次微调的增减幅度",
        tuneWindow: "测速窗口(秒)",
        tuneWindowHint: "计算实际速度的窗口长度",
        tuneLow: "下限比例",
        tuneLowHint: "低于 target×该值时下调间隔",
        tuneHigh: "上限比例",
        tuneHighHint: "高于 target×该值时上调间隔",
        tuneCooldown: "微调冷却(秒)",
        tuneCooldownHint: "两次微调之间的最小间隔",
        source: "来源",
        effective: "生效间隔",
        saved: "已保存 Alpha 限速配置",
        loadError: "读取 Alpha 限速配置失败",
        saveError: "保存 Alpha 限速配置失败",
      },
      ib: {
        title: "Brokerage 交易连接",
        meta: "配置 Lean Bridge 连接与行情模式",
        status: "连接状态",
        lastHeartbeat: "最后心跳",
        stateUpdated: "状态更新时间",
        message: "状态消息",
        probe: "连接测试",
        probeOk: "已完成连接测试",
        probeError: "连接测试失败",
        stateLoadError: "读取连接状态失败",
        settingsTitle: "连接配置",
        host: "主机",
        hostHint: "IB Gateway/TWS 主机地址",
        port: "端口",
        portHint: "Paper 常用 7497，Live 常用 7496",
        clientId: "客户端 ID",
        clientIdHint: "Brokerage clientId（由 Lean 管理，避免冲突）",
        accountId: "账户号",
        accountIdPlaceholder: "如需指定账户可填写",
        accountIdHint: "已配置账户 {account}",
        apiMode: "数据源模式",
        apiModeHint: "数据由 Lean Bridge 提供，Mock 仅用于离线演示",
        apiModeIb: "Lean Bridge",
        apiModeMock: "Mock 模拟",
        regulatorySnapshot: "监管快照",
        regulatorySnapshotHint: "启用后使用 NBBO 监管快照（每次请求可能产生费用）",
        mode: "账户模式",
        modeHint: "Paper 或 Live 模式",
        modePaper: "模拟盘",
        modeLive: "实盘",
        marketDataType: "行情类型",
        marketDataTypeHint: "实时/冻结/延迟",
        marketDataRealtime: "实时",
        marketDataFrozen: "冻结",
        marketDataDelayed: "延迟",
        contractsTitle: "合约缓存",
        contractsSymbols: "标的列表",
        contractsSymbolsPlaceholder: "多个标的用逗号或空格分隔，如 SPY AAPL",
        contractsSymbolsHint: "用于刷新 symbol→conId 的合约缓存",
        contractsProjectOnly: "仅项目标的",
        contractsProjectOnlyHint: "使用所有激活项目的标的刷新缓存",
        contractsRefresh: "刷新合约缓存",
        contractsResult: "已刷新 {updated}/{total}，跳过 {skipped}，耗时 {duration}s",
        contractsError: "合约缓存刷新失败",
        healthTitle: "行情健康检查",
        healthSymbols: "检查标的",
        healthSymbolsPlaceholder: "多个标的用逗号或空格分隔",
        healthSymbolsHint: "用于检查行情可用性（无订阅时可回退历史）",
        healthProjectOnly: "仅项目标的",
        healthProjectOnlyHint: "使用所有激活项目标的进行检查",
        healthMinRatio: "最低成功率",
        healthMinRatioHint: "低于该比例将判定为阻断",
        healthFallback: "回退历史",
        healthFallbackHint: "无快照时使用历史数据作为开发期替代",
        healthDuration: "历史周期",
        healthDurationHint: "回退历史数据的时间跨度",
        healthDuration5d: "最近 5 天",
        healthDuration30d: "最近 30 天",
        healthDuration90d: "最近 90 天",
        healthBarSize: "历史粒度",
        healthBarSizeHint: "回退历史的 bar 粒度",
        healthBarDay: "日线",
        healthBarHour: "小时线",
        healthUseRth: "仅常规时段",
        healthUseRthHint: "仅使用常规交易时段",
        healthCheck: "检查行情",
        healthResult: "状态 {status} · 成功 {success}/{total}",
        healthError: "行情健康检查失败",
        historyTitle: "历史数据补齐",
        historySymbols: "补齐标的",
        historySymbolsPlaceholder: "多个标的用逗号或空格分隔",
        historySymbolsHint: "用于拉取 IB 历史数据补齐",
        historyProjectOnly: "仅项目标的",
        historyProjectOnlyHint: "使用所有激活项目的标的",
        historyDuration: "历史周期",
        historyDurationHint: "拉取历史数据的时间跨度",
        historyDuration5d: "最近 5 天",
        historyDuration30d: "最近 30 天",
        historyDuration90d: "最近 90 天",
        historyDuration1y: "最近 1 年",
        historyBarSize: "历史粒度",
        historyBarSizeHint: "拉取历史的 bar 粒度",
        historyBarDay: "日线",
        historyBarHour: "小时线",
        historyUseRth: "仅常规时段",
        historyUseRthHint: "仅使用常规交易时段",
        historyStore: "写入文件",
        historyStoreHint: "写入 data_root/ib/bars",
        historyDelay: "请求间隔(秒)",
        historyDelayHint: "每个标的之间的等待时间",
        historyStart: "开始补齐",
        historyLoadError: "读取历史任务失败",
        historyStartError: "发起历史任务失败",
        historyCancel: "取消",
        historyCancelError: "取消历史任务失败",
        historyProgress: "进度",
        historySuccess: "成功/失败",
        historyEmpty: "暂无历史任务",
        streamTitle: "行情订阅",
        streamMeta: "订阅 Lean Bridge L1 行情并持续写入 stream 文件",
        streamStatus: "订阅状态",
        streamLastHeartbeat: "订阅心跳",
        streamSubscribed: "订阅标的",
        streamErrorCount: "错误次数",
        streamLastError: "最后错误",
        streamMarketDataType: "行情类型",
        streamProjectId: "项目 ID",
        streamProjectIdHint: "用于生成订阅标的集合",
        streamDecisionSnapshotId: "快照 ID",
        streamDecisionSnapshotIdHint: "可选，优先使用快照标的",
        streamMaxSymbols: "最大标的数",
        streamMaxSymbolsHint: "限制订阅数量",
        streamMarketDataTypeHint: "订阅使用的行情类型",
        streamStart: "启动订阅",
        streamStop: "停止订阅",
        streamRefresh: "刷新状态",
        streamLoadError: "读取订阅状态失败",
        streamStartError: "启动订阅失败",
        streamStopError: "停止订阅失败",
        streamProjectRequired: "需要填写项目 ID",
        saved: "已保存 Brokerage 连接配置",
        loadError: "读取 Brokerage 配置失败",
        saveError: "保存 Brokerage 配置失败",
      },
      tradingCalendar: {
        title: "交易日历配置",
        meta: "交易日历来源与覆盖范围 · 配置 {path}",
        source: "配置来源",
        calendarSource: "日历来源",
        coverage: "覆盖区间",
        generatedAt: "生成时间",
        previewTitle: "交易日预览",
        previewAsOf: "统计日期(美东)",
        previewTimezone: "时区",
        latestDay: "最近交易日",
        nextDay: "下一个交易日",
        sessions: "交易日数量",
        overridesApplied: "覆盖调整次数",
        weekDays: "本周交易日 ({count} 天)",
        calendarViewTitle: "月历视图",
        prevMonth: "上月",
        nextMonth: "下月",
        recentDays: "最近交易日",
        upcomingDays: "未来交易日",
        previewEmpty: "暂无数据",
        configTitle: "日历参数",
        sourceMode: "来源模式",
        sourceModeHint: "优先级 auto/local/exchange_calendars/lean/spy",
        exchange: "交易所代码",
        exchangeHint: "默认 XNYS (NYSE)",
        startDate: "起始日期",
        startDateHint: "生成日历的起始日期",
        endDate: "结束日期",
        endDateHint: "生成日历的结束日期",
        refreshDays: "刷新窗口(天)",
        refreshDaysHint: "仅刷新最近 N 天",
        overrides: "覆盖 overrides",
        overridesHint: "应用临时停市/特殊交易日覆盖",
        refresh: "刷新交易日历",
        calendarPath: "日历文件 {path}",
        overridesPath: "覆盖文件 {path}",
        saved: "已保存交易日历配置",
        refreshed: "交易日历已刷新",
        loadError: "读取交易日历配置失败",
        previewError: "读取交易日预览失败",
        saveError: "保存交易日历配置失败",
        refreshError: "刷新交易日历失败",
        weekdayMon: "周一",
        weekdayTue: "周二",
        weekdayWed: "周三",
        weekdayThu: "周四",
        weekdayFri: "周五",
        weekdaySat: "周六",
        weekdaySun: "周日",
      },
    },
    trade: {
      title: "实盘交易",
      meta: "Brokerage 执行与运行状态概览",
      overviewTitle: "连接状态面板",
      overviewMeta: "Brokerage 连接与执行链路聚合状态",
      overviewPartial: "部分指标不可用",
      overviewError: "连接状态面板加载失败",
      overviewRefresh: "刷新面板",
      overviewStatusLabel: "连接状态",
      overviewRefreshedAt: "刷新时间",
      overviewStreamLabel: "行情订阅",
      overviewStreamCount: "订阅数",
      overviewSnapshotLabel: "快照缓存",
      overviewSnapshotAt: "最近快照",
      bridgeLabel: "Lean Bridge 数据源",
      bridgeSource: "来源",
      bridgeUpdatedAt: "最近更新",
      overviewOrderLabel: "最近订单",
      overviewOrderAt: "订单时间",
      overviewAlertLabel: "最近告警",
      overviewAlertAt: "告警时间",
      snapshotTitle: "行情快照",
      snapshotMeta: "标的最新价格与成交概览",
      snapshotEmpty: "暂无快照数据",
      snapshotVolume: "成交量",
      snapshotUpdatedAt: "更新时间",
      snapshotRefresh: "刷新快照",
      snapshotError: "行情快照加载失败",
      overview: {
        status: {
          ok: "正常",
          down: "断开",
          partial: "部分可用",
          unknown: "未知",
        },
      },
      bridgeStatus: {
        ok: "正常",
        stale: "过期",
        unknown: "未知",
      },
      statusTitle: "交易状态",
      statusMeta: "Brokerage 连接与配置状态",
      statusLabel: "状态",
      statusHint: "尚未配置 Brokerage 连接，请先完成数据页配置。",
      liveWarning: "当前为实盘模式，请确认账户与风控配置后再执行。",
      status: {
        unconfigured: "未配置",
        unknown: "未知",
        connected: "已连接",
        disconnected: "未连接",
      },
      connectionUpdatedAt: "状态更新时间",
      modeLabel: "账户模式",
      mode: {
        paper: "模拟盘",
        live: "实盘",
      },
      marketDataType: "行情类型",
      configTitle: "账户配置",
      configMeta: "已配置的 IB 连接信息（敏感字段已脱敏）",
      host: "主机",
      port: "端口",
      account: "账户",
      apiMode: "API 模式",
      regulatorySnapshot: "监管快照",
      accountSummaryTitle: "账户概览",
      accountSummaryMeta: "Lean bridge 账户快照",
      accountSummaryUpdatedAt: "最近刷新",
      accountSummarySource: "数据来源",
      accountSummaryStale: "数据过期",
      accountSummaryRefresh: "手动刷新（全量）",
      accountSummaryFullTitle: "全量账户标签",
      accountSummaryFullEmpty: "暂无摘要数据",
      accountSummaryTag: "标签",
      accountSummaryValue: "数值",
      accountSummaryError: "账户摘要加载失败",
      accountPositionsTitle: "当前持仓",
      accountPositionsMeta: "Lean bridge 持仓快照",
      accountPositionsUpdatedAt: "最近刷新",
      accountPositionsEmpty: "暂无持仓或未刷新",
      accountPositionsError: "持仓加载失败",
      accountPositionsStaleHint:
        "持仓为空且数据已过期，可能是 Lean Bridge 未更新。请检查 Lean 运行状态或点击刷新。",
      accountPositionsStaleUpdatedAt: "Bridge 最近心跳",
      accountPositionsRefresh: "刷新持仓",
      positionTable: {
        symbol: "标的",
        position: "持仓",
        avgCost: "成本价",
        marketPrice: "市价",
        marketValue: "市值",
        unrealized: "未实现盈亏",
        realized: "已实现盈亏",
        account: "账户",
        currency: "币种",
      },
      openData: "前往数据配置",
      refresh: "刷新状态",
      errorLoad: "加载失败，请检查后端服务",
      dataTitle: "实盘数据源状态",
      dataMeta: "IB 合约缓存与历史补齐任务",
      dataError: "实盘数据状态加载失败",
      contractCache: "合约缓存",
      contractCacheHint: "仅展示前 200 条缓存",
      historyJob: "历史补齐任务",
      historyJobEmpty: "暂无历史补齐任务",
      historyTable: {
        id: "任务 ID",
        status: "状态",
        progress: "进度",
        updatedAt: "更新时间",
      },
      guardTitle: "盘中风控",
      guardMeta: "盘中风险状态与估值来源",
      guardStatus: "风控状态",
      guardEquity: "最新估值",
      guardDrawdown: "回撤",
      guardValuationSource: "估值来源",
      guardValuationTime: "估值时间",
      guardCooldown: "冷却到期",
      guardOrderFailures: "订单失败",
      guardMarketErrors: "行情异常",
      guardRiskTriggers: "风控触发",
      guardReason: "触发原因",
      guardEmpty: "暂无风控状态",
      guardError: "风控状态加载失败",
      projectBindingTitle: "项目绑定",
      projectBindingMeta: "绑定项目与当日决策快照",
      projectSelect: "选择项目",
      projectSelectPlaceholder: "请选择项目",
      projectSelectHint: "请选择项目后执行。",
      projectBindingSelected: "已绑定项目：#{id} · {name}",
      projectLoadError: "项目列表加载失败",
      snapshotStatus: "快照状态",
      snapshotReady: "已就绪",
      snapshotMissing: "未生成快照，无法执行。",
      snapshotDate: "快照日期",
      snapshotId: "快照 ID",
      snapshotLoadError: "快照加载失败",
      executeContext: "执行上下文",
      executeBlockedProject: "请选择项目后执行。",
      executeBlockedSnapshot: "当日快照未生成，无法执行。",
      projectShort: "项目#",
      id: {
        project: "项目",
        snapshot: "快照",
        run: "批次",
      },
      executionTitle: "下单执行与风控",
      executionMeta: "最近交易批次与执行状态",
      executionDataSource: "执行数据源",
      signalDataSource: "信号数据源",
      signalDataSourceValue: "Alpha（训练/回测）",
      tradeSettingsError: "交易配置加载失败",
      tradeError: "交易执行信息加载失败",
      latestRun: "最新执行批次",
      runMode: "运行模式",
      runProject: "项目",
      runEmpty: "暂无交易执行记录",
      runTable: {
        id: "批次 ID",
        status: "状态",
        mode: "模式",
        snapshot: "决策快照",
        createdAt: "创建时间",
      },
      runSelect: "选择批次",
      runSelectHint: "选择批次以查看目标偏离与成交明细",
      detailRefresh: "刷新明细",
      detailError: "批次明细加载失败",
      symbolSummaryTitle: "目标偏离概览",
      symbolSummaryMeta: "目标权重与成交偏离对比",
      symbolSummaryUpdatedAt: "明细更新时间",
      symbolSummaryEmpty: "暂无偏离数据",
      symbolTable: {
        symbol: "标的",
        targetWeight: "目标权重",
        targetValue: "目标市值",
        filledQty: "已成交量",
        avgPrice: "成交均价",
        filledValue: "已成交市值",
        pendingQty: "未成交量",
        deltaValue: "偏离市值",
        deltaWeight: "偏离权重",
        fillRatio: "完成率",
        status: "最新状态",
      },
      ordersTitle: "订单明细",
      fillsTitle: "成交明细",
      fillsEmpty: "暂无成交记录",
      fillTable: {
        orderId: "订单",
        execId: "成交号",
        qty: "成交量",
        price: "成交价",
        commission: "佣金",
        exchange: "交易所",
        time: "成交时间",
      },
      executeRunId: "执行批次 ID",
      executeRunIdHint: "输入需要执行的交易批次 ID（默认最新）",
      executeToken: "实盘确认口令",
      executeTokenHint: "实盘执行需要输入确认口令（仅 Live 模式要求）",
      executeSubmit: "执行交易批次",
      executeSuccess: "执行请求已提交",
      executeError: "执行请求失败",
      executeRunRequired: "请输入有效的交易批次 ID",
      monitorTitle: "实盘监控",
      monitorMeta: "最近订单与执行明细",
      orderEmpty: "暂无订单记录",
      orderTable: {
        id: "订单 ID",
        symbol: "标的",
        side: "方向",
        qty: "数量",
        status: "状态",
        createdAt: "创建时间",
      },
    },
    pagination: {
      prev: "上一页",
      next: "下一页",
      page: "第 {page} / {pages} 页",
      total: "共 {total} 条",
      range: "显示 {start}-{end}",
      pageSize: "每页",
    },
    audit: {
      title: "审计日志",
      filters: {
        title: "筛选条件",
        meta: "支持 action / resource_type / resource_id",
        action: "action (backtest.create)",
        resourceType: "resource_type (dataset)",
        resourceId: "resource_id (数字)",
      },
      table: {
        id: "ID",
        time: "时间",
        action: "动作",
        resource: "资源",
        detail: "详情",
        empty: "暂无审计记录",
      },
    },
  },
  en: {
    nav: {
      projects: "Projects",
      themes: "Theme Library",
      algorithms: "Algorithms",
      backtests: "Backtests & Reports",
      reports: "Reports",
      data: "Data",
      liveTrade: "Live Trading",
      audit: "System Audit",
    },
    app: {
      footer: "Local Quant Platform · Lean Engine",
    },
    topbar: {
      localRunner: "Local Runner",
      leanEngine: "Lean Engine",
      switchLanguage: "Switch Language",
      timezone: "Time Zone",
      timezoneOptions: {
        et: "US Eastern (ET)",
        utc: "UTC",
        cn: "China Standard (CST)",
        hk: "Hong Kong (HKT)",
      },
      localeShort: {
        zh: "中文",
        en: "EN",
      },
    },
    common: {
      none: "-",
      noneText: "None",
      boolean: {
        true: "Yes",
        false: "No",
      },
      status: {
        queued: "Queued",
        running: "Running",
        success: "Success",
        failed: "Failed",
        cancel_requested: "Canceling",
        canceled: "Canceled",
        skipped: "Skipped",
        connected: "Connected",
        disconnected: "Disconnected",
        unknown: "Unknown",
        ok: "OK",
        warn: "Warning",
        rate_limited: "Rate Limited",
        not_found: "Not Found",
      },
      actions: {
        create: "Create",
        save: "Save",
        saved: "Saved",
        saveVersion: "Save Version",
        start: "Start",
        compare: "Compare",
        generateDiff: "Generate Diff",
        run: "Run Backtest",
        view: "View",
        download: "Download",
        query: "Search",
        refresh: "Refresh",
        syncAll: "Sync All",
        scan: "Run Scan",
        loadCharts: "Load Charts",
        loading: "Loading",
        close: "Close",
      },
      labels: {
        id: "ID",
        status: "Status",
        createdAt: "Created At",
        updatedAt: "Updated At",
        endedAt: "Ended At",
        actions: "Actions",
      },
    },
    symbols: {
      types: {
        stock: "Stock",
        etf: "ETF",
        adr: "ADR",
        reit: "REITs",
        etn: "ETN",
        fund: "Fund",
        index: "Index",
        unknown: "Unknown",
      },
    },
    metrics: {
      cagr: "CAGR",
      drawdown: "Max Drawdown",
      drawdownAll: "Max Drawdown (All)",
      drawdown52w: "Max Drawdown (52w)",
      sharpe: "Sharpe Ratio",
      netProfit: "Net Profit",
      totalFees: "Total Fees",
      turnover: "Portfolio Turnover",
      turnoverWeek: "Weekly Turnover Cap",
      turnoverWeekAvg: "Weekly Turnover (Avg)",
      turnoverWeekLast: "Weekly Turnover (Latest)",
      turnoverWeekAnnualized: "Weekly Turnover (Annualized Est.)",
      turnoverSanityRatio: "Turnover Sanity (Portfolio/Weekly)",
      riskStatus: "Risk Status",
    },
    charts: {
      noData: "No data available",
      pointsSummary: "Points {count}, start {start}, end {end}",
      equityCurve: "Equity Curve (Strategy Equity)",
      drawdownCurve: "Drawdown Curve (Drawdown)",
      performanceTitle: "Equity & Drawdown Overlay",
      performanceMeta: "Overlay equity, drawdown, benchmark, and exposure",
      toggleEquity: "Equity",
      toggleDrawdown: "Drawdown",
      toggleBenchmark: "Benchmark",
      toggleBenchmarkDrawdown: "Benchmark Drawdown",
      toggleExposure: "Exposure/Cash",
      exposureModeRatio: "Ratio",
      exposureModeValue: "Value",
      legendDate: "Date",
      seriesEquity: "Equity",
      seriesDrawdown: "Drawdown",
      seriesBenchmark: "Benchmark",
      seriesBenchmarkDrawdown: "Benchmark Drawdown",
      seriesLongExposure: "Invested",
      seriesDefensiveExposure: "Defensive Allocation",
      seriesCashExposure: "Cash",
    },
    projects: {
      title: "Project Management",
      new: {
        title: "New Project",
        meta: "Organize algorithms and backtest runs.",
        name: "Project Name",
        description: "Project Description",
        errorName: "Project name is required.",
      },
      overview: {
        title: "Project Overview",
        meta: "Total projects",
      },
      list: {
        title: "Project List",
        meta: "Pick a project to manage",
        search: "Search project name",
        showArchived: "Show archived projects",
        archivedTag: "Archived",
        empty: "No projects found",
      },
      detail: {
        empty: "Select a project to view details",
        projectId: "Project ID",
        openThemes: "Open Themes",
        archivedLabel: "Archived",
        archive: "Archive Project",
        restore: "Restore Project",
        archiveConfirm: "Archive project \"{name}\"? It will be hidden from the list.",
        restoreConfirm: "Restore project \"{name}\"?",
        archiveSuccess: "Project archived",
        restoreSuccess: "Project restored",
        archiveError: "Failed to archive project",
        restoreError: "Failed to restore project",
        summaryTitle: "Project Overview",
        summaryMeta: "Core setup and coverage",
        themeTitle: "Theme Weights",
        themeMeta: "Weight distribution snapshot",
        symbolsTotalLabel: "Project Symbols",
        performanceTitle: "Latest Backtest",
        performanceMeta: "Portfolio vs benchmark key metrics",
      },
      tabs: {
        overview: "Overview",
        config: "Config",
        algorithm: "Algorithm",
        data: "Data",
        backtest: "Backtest",
        versions: "Versions",
        diff: "Diff",
      },
      table: {
        project: "Project",
        description: "Description",
        createdAt: "Created At",
      },
      config: {
        title: "Project Config",
        meta: "Universe scope, data sources, and weights",
        universeMode: "Universe Scope",
        universeHistory: "Historical constituents",
        universeCurrent: "Current constituents",
        frequency: "Data Frequency",
        frequencyDaily: "Daily",
        frequencyMinute: "Minute (paid data)",
        vendorPrimary: "Primary Source",
        vendorFallback: "Fallback Source",
        vendorLockedHint: "Locked to Alpha-only and enforced on save.",
        benchmark: "Benchmark",
        rebalance: "Rebalance Frequency",
        rebalanceDaily: "Daily",
        rebalanceWeekly: "Weekly",
        rebalanceMonthly: "Monthly",
        rebalanceQuarterly: "Quarterly",
        weights: "Theme Weights",
        themesTitle: "Theme Baskets",
        themesEmpty: "No themes yet. Add one to continue.",
        themeKey: "Theme Code",
        themeLabel: "Theme Name",
        themeWeight: "Theme Weight",
        themePriority: "Priority",
        themeKeywords: "Keywords (for screening, comma-separated)",
        themeManual: "Manual Constituents (comma-separated)",
        themeManualShort: "Manual Constituents",
        themeExclude: "Excluded Constituents (comma-separated)",
        themeExcludeShort: "Excluded Constituents",
        themeAdd: "Add Theme",
        themeRemove: "Remove",
        themeHint:
          "Keywords drive Yahoo search; manual constituents are forced; exclusions override auto/manual; overlaps follow priority.",
        themeSystem: "System Theme",
        systemThemeTitle: "System Theme Library",
        systemThemeMeta: "Authoritative theme baskets ready for project import.",
        systemThemeLabel: "Theme",
        systemThemeSource: "Source",
        systemThemeVersion: "Latest Version",
        systemThemeMode: "Import Mode",
        systemThemeWeight: "Weight",
        systemThemeActions: "Actions",
        systemThemeImport: "Import",
        systemThemeReimport: "Update Binding",
        systemThemeRefresh: "Refresh",
        systemThemeEmpty: "No system themes yet",
        systemThemeError: "Failed to load system themes",
        systemThemeImported: "System theme imported and saved",
        systemThemeImportError: "Failed to import system theme",
        systemThemeRefreshSuccess: "System theme refreshed",
        systemThemeRefreshError: "Failed to refresh system theme",
        systemThemeModeFollow: "Follow Latest",
        systemThemeModePin: "Pin Version",
        systemThemeModeSnapshot: "Snapshot",
        systemThemeReportTitle: "Impact Reports",
        systemThemeReportMeta: "Summaries for system theme updates.",
        systemThemeReportEmpty: "No impact reports",
        systemThemeReportVersion: "Version Change",
        systemThemeReportDiff: "Delta",
        systemThemeReportTime: "Created At",
        systemThemeReportActions: "Actions",
        systemThemeReportExpand: "Expand",
        systemThemeReportCollapse: "Collapse",
        systemThemeReportNone: "No changes",
        systemThemeDiffSymbols: "Symbols",
        systemThemeDiffKeywords: "Keywords",
        systemThemeDiffManual: "Manual",
        systemThemeDiffExclude: "Excluded",
        themeDuplicate: "Duplicate theme keys. Please fix before saving.",
        themeActions: "Actions",
        themeCount: "Themes",
        themeSummaryError: "Failed to load theme summary.",
        themeTotalSymbols: "Total Constituents",
        themeComposition: "Theme Composition",
        themeSymbolCount: "Constituents",
        themeSample: "Sample Constituents",
        themeDistribution: "Distribution",
        themeWeightDistribution: "Weight Split",
        themeExpand: "Expand",
        themeCollapse: "Collapse",
        themeEmptySymbols: "No symbols",
        themeView: "View",
        themeClose: "Hide",
        themeFilter: "Theme Filter",
        themeFilterPlaceholder: "Filter by theme name or key",
        themeSearchSymbol: "Constituent Filter",
        themeSearchPlaceholder: "Enter a security symbol (e.g., AAPL)",
        themeSearchHint: "Filter themes by constituent",
        themeSearchClear: "Clear",
        themeSearchEmpty: "Enter a symbol to filter.",
        themeSearchError: "Symbol filter failed.",
        themeSearchMatches: "{count} themes matched",
        themeDetailTitle: "Theme Detail · {name}",
        themeDetailMeta: "{total} constituents (manual {manual} · excluded {excluded})",
        themeDetailFilter: "Filter constituents in theme",
        themeDetailClear: "Clear",
        themeDetailExport: "Export",
        themeDetailAuto: "Auto Constituents",
        themeDetailManual: "Manual Constituents",
        themeDetailExcluded: "Excluded Constituents",
        themeSymbolPlaceholder: "Enter symbol",
        themeSymbolAdd: "Add to Theme",
        themeSymbolExclude: "Exclude from Theme",
        themeSymbolExcludeAction: "Exclude",
        themeSymbolRemove: "Remove",
        themeSymbolRestore: "Restore",
        themeSymbolEmpty: "Please enter a symbol first.",
        themeCompareTitle: "Theme Comparison",
        themeCompareA: "Theme A",
        themeCompareB: "Theme B",
        themeCompareEmpty: "Select a theme",
        themeCompareShared: "Overlap",
        themeCompareOnlyA: "Only A",
        themeCompareOnlyB: "Only B",
        themeCompareError: "Failed to load comparison data.",
        includeHistory: "Include historical constituents",
        assetTypes: "Asset type filter",
        assetTypesHint: "Leave empty for no filter. Prefer Stock to exclude ETFs/ADRs.",
        assetTypesLockedHint: "Locked to Stock only for training and backtests.",
        pitUniverseOnly: "Use PIT weekly universe only",
        pitUniverseOnlyHint: "Limit candidates to PIT weekly snapshots to avoid not_in_pit drops.",
        riskFreeRate: "Risk-free rate",
        backtestStart: "Backtest start date",
        backtestEnd: "Backtest end date",
        backtestRangeHint: "Leave empty to use the full available range.",
        backtestRangeTitle: "Backtest range",
        backtestRangeMeta: "Set the backtest window for the next run.",
        sectionUniverse: "Universe",
        sectionData: "Data",
        sectionThemes: "Themes",
        sectionPortfolio: "Portfolio",
        themeMovedHint: "Theme management moved to the Themes page.",
        weightTotal: "Weight Total",
        source: "Config Source",
        save: "Save Config",
        saved: "Config saved",
        error: "Save failed. Check config.",
      },
      dataStatus: {
        title: "Data Status",
        meta: "S&P500 history and theme coverage",
        membership: "Historical constituents",
        range: "History range",
        universe: "Combined universe",
        themes: "Theme categories",
        metrics: "Metrics snapshots",
        prices: "Price files",
        backtestLog: "Backtest log path",
        backtestOutput: "Backtest output directory",
        backtestArtifact: "Backtest artifact directory",
        root: "Data root",
        action: "Refresh Data",
        queued: "Refresh queued",
        error: "Refresh failed",
      },
      algorithm: {
        title: "Algorithm Binding",
        meta: "Select the algorithm version for this project",
        algorithm: "Algorithm",
        version: "Version",
        selectAlgorithm: "Select algorithm",
        selectVersion: "Select version",
        lock: "Lock algorithm version",
        current: "Current binding",
        summaryTitle: "Algorithm Version Summary",
        summaryMeta: "Key metadata for the selected version",
        summaryCurrent: "Current version",
        summaryVersionId: "Version ID",
        summaryType: "Algorithm Type",
        summaryLanguage: "Language",
        summaryPath: "File Path",
        summaryParams: "Params Count",
        summaryEmpty: "No algorithm version selected",
        summaryError: "Failed to load version details",
        openLibrary: "Open Algorithm Library",
        openLibrarySummary: "Library & Version Summary",
        save: "Save binding",
        saved: "Binding saved",
        error: "Binding failed",
        errorSelect: "Select algorithm and version",
      },
    strategy: {
      title: "Strategy Source",
      meta: "Choose theme weights / factor baseline / ML scores as the signal source",
        source: "Signal Source",
        sourceTheme: "Theme Weights",
        sourceFactor: "Factor Baseline",
        sourceMl: "ML Scores",
        scorePath: "Score File",
        scorePathHint: "e.g. ml/models/factor_scores.csv",
        scoreTopN: "Top N",
        scoreWeighting: "Weighting",
        weightScore: "Score",
        weightEqual: "Equal",
        scoreMin: "Min Score",
        scoreMaxWeight: "Max Weight",
        scoreFallback: "Fallback",
        fallbackTheme: "Theme Weights",
        fallbackUniverse: "Universe",
        fallbackSkip: "Skip",
        themeHint: "Theme weights mode does not require scores",
        save: "Save Strategy",
      },
      factorScores: {
        title: "Factor Baseline Scores",
        meta: "Generate baseline scores from PIT weekly snapshots",
        start: "Start Date",
        startHint: "e.g. 2024-01-01",
        end: "End Date",
        endHint: "e.g. 2024-03-31",
        config: "Factor Config",
        configHint: "Default configs/factor_scores.json",
        output: "Output Path",
        outputHint: "Default ml/models/factor_scores.csv",
        overwrite: "Rebuild cache",
        action: "Generate Scores",
        queued: "Score job queued",
        error: "Score job failed",
        empty: "No score jobs yet",
        latest: "Latest Job",
        scoresPath: "Score File",
        logPath: "Log Path",
        table: {
          id: "Job ID",
          status: "Status",
          createdAt: "Created At",
        },
        status: {
          queued: "Queued",
          running: "Running",
          success: "Success",
          failed: "Failed",
          unknown: "Unknown",
        },
      },
      ml: {
        title: "Model Training",
        meta: "Retrain scoring model with current project universe",
        symbolCount: "Symbols",
        benchmark: "Benchmark",
        current: "Current Model",
        currentJob: "Job #{id}",
        device: "Device",
        deviceAuto: "Auto",
        deviceCpu: "CPU",
        deviceCuda: "GPU",
        modelType: "Model Type",
        modelTypeTorch: "Torch MLP",
        modelTypeLgbm: "LightGBM Rank",
        modelTypeHint: "LightGBM requires extra dependencies.",
        symbolSource: "Training Universe",
        symbolSourceHint: "Choose project themes or system themes for training symbols.",
        symbolSourceProject: "Project themes",
        symbolSourceProjectShort: "Project",
        symbolSourceSystem: "System theme",
        symbolSourceSystemShort: "System",
        systemTheme: "System Theme",
        systemThemeHint: "Use a system theme to override training symbols.",
        systemThemeError: "Failed to load system themes",
        systemThemeRequired: "Please select a system theme",
        trainYears: "Train Years",
        trainStartYear: "Training Start Year",
        trainStartYearPlaceholder: "e.g. 2010",
        trainStartYearHint:
          "Optional; earliest recommended is 2000 (1999-11 data + 252-day warmup).",
        validMonths: "Validation Months",
        walkForward: "Walk-Forward",
        walkForwardHint: "Enable rolling train/valid/test windows to generate scores.",
        testMonths: "Test Months",
        stepMonths: "Step Months",
        horizonDays: "Horizon (days)",
        lgbm: {
          learningRate: "Learning rate",
          learningRateHint: "Default 0.05; adjust for stability.",
          numLeaves: "Num leaves",
          numLeavesHint: "Default 31; higher means more complexity.",
          minDataInLeaf: "Min data in leaf",
          minDataInLeafHint: "Default 50; helps control overfit.",
          estimators: "Estimators",
          estimatorsHint: "Default 200.",
          subsample: "Subsample",
          subsampleHint: "Default 0.8; reduces overfit.",
          colsampleBytree: "Colsample by tree",
          colsampleBytreeHint: "Default 0.8; reduces overfit.",
        },
        sampleWeighting: "Sample Weighting",
        sampleWeightingHint:
          "Market cap from PIT snapshot; dollar volume = raw close × raw volume.",
        sampleWeightingNone: "None",
        sampleWeightingDollarVolume: "Dollar volume",
        sampleWeightingMarketCap: "Market cap",
        sampleWeightingMix: "Market cap + dollar volume (mix)",
        sampleWeightAlpha: "Market cap weight α",
        sampleWeightAlphaHint: "Higher α emphasizes market cap (0-1).",
        sampleWeightDvWindow: "Dollar volume window (days)",
        sampleWeightDvWindowHint: "Rolling window for dollar volume.",
        pitMissingPolicy: "PIT missing policy",
        pitMissingPolicyFillZero: "Fill missing with 0",
        pitMissingPolicyDrop: "Drop missing rows",
        pitMissingPolicyHint: "How to handle missing PIT fundamentals.",
        pitSampleOnSnapshot: "Sample PIT on snapshot date",
        pitSampleOnSnapshotHint: "Align PIT fundamentals to the snapshot date.",
        pitMinCoverage: "PIT min coverage",
        pitMinCoverageHint: "Skip training if coverage is below this ratio.",
        modelParams: "Advanced Params (JSON)",
        modelParamsPlaceholder: 'e.g. {"learning_rate": 0.04, "num_leaves": 63}',
        modelParamsHint: "Optional; overrides explicit params above.",
        modelParamsError: "Model params JSON is invalid",
        train: "Retrain",
        cancel: "Stop",
        canceling: "Stopping",
        queued: "Training job queued",
        cancelRequested: "Cancel requested",
        cancelError: "Cancel failed",
        activated: "Set as current model",
        activateError: "Activate failed",
        error: "Training failed",
        active: "Active",
        detail: "Detail",
        activate: "Set Current",
        empty: "No training jobs yet",
        detailTitle: "Job Detail",
        detailStatus: "Status",
        detailModel: "Model Type",
        detailProgress: "Progress",
        detailPhase: "Phase",
        detailWindow: "Window",
        detailEpoch: "Epoch",
        detailOutput: "Output Dir",
        detailScores: "Scores",
        detailLog: "Log",
        detailConfig: "Training config",
        detailMessage: "Error",
        detailMetric: "Metric",
        detailBestScore: "Best Score",
        detailQualityScore: "Quality Score",
        detailCurveGap: "Curve Gap (train-valid)",
        detailBestLoss: "Best Loss",
        detailBestIteration: "Best Iteration",
        detailNdcg10: "NDCG@10 (avg)",
        detailNdcg50: "NDCG@50 (avg)",
        detailNdcg100: "NDCG@100 (avg)",
        detailIc: "IC (avg)",
        detailRankIc: "RankIC (avg)",
        metricCurveTitle: "Training Curve",
        metricCurveMetric: "Metric: {metric}",
        metricCurveTrain: "Train",
        metricCurveValid: "Valid",
        metricCurveValidScaled: "Valid (scaled)",
        metricCurveBest: "Best (valid) {value} @ {iteration}",
        metricCurveEmpty: "No training curve",
        sweep: {
          title: "Single-Param Sweep",
          meta: "Batch training over a single parameter range",
          paramKey: "Parameter",
          paramKeyPlaceholder: "e.g. learning_rate",
          paramHint:
            "Common (LGBM): learning_rate / num_leaves / min_data_in_leaf / n_estimators / subsample / colsample_bytree / rank_label_bins",
          start: "Start",
          end: "End",
          step: "Step",
          stepHint: "Supports decimals, e.g. 0.005",
          includeEnd: "Include end value",
          preview: "Will create {count} jobs: {values}",
          backtestPreset: "Backtest preset: {preset}",
          action: "Run Sweep",
          paramRequired: "Please fill the parameter name",
          pipelineRequired: "Select or auto-create a pipeline first",
          rangeError: "Invalid range; check start/end/step",
          rangeOrderError: "Start must be <= end",
          stepError: "Step must be > 0",
          tooMany: "Too many values (max {limit})",
          backtestMismatch: "Preset is {preset}; switch to E35 first",
          progress: "Submitted {current}/{total}",
          queued: "Submitted {count} training jobs",
          error: "Sweep failed",
          summaryTitle: "Sweep Summary",
          summaryParam: "Parameter",
          summaryRange: "Range/Step",
          best: "Best Result",
          bestScore: "Train score {score}",
          bestBadge: "Best",
        },
        table: {
          id: "ID",
          status: "Status",
          progress: "Progress",
          window: "Window",
          range: "Train/Valid/Test Range",
          trainRange: "Train",
          trainRangeShort: "Tr",
          validRange: "Valid",
          validRangeShort: "Val",
          testRange: "Test",
          testRangeShort: "Te",
          model: "Model",
          horizon: "Horizon",
          symbols: "Coverage",
          device: "Device",
          createdAt: "Created At",
          actions: "Actions",
        },
        status: {
          queued: "Queued",
          running: "Running",
          success: "Success",
          failed: "Failed",
          unknown: "Unknown",
        },
      },
      decision: {
        title: "Daily Model Decision",
        meta: "Generate daily picks from the latest PIT snapshot and scores",
        trainJob: "Training job",
        trainJobAuto: "Auto (current active model)",
        trainJobHint: "Current model #{id}",
        snapshotDate: "Snapshot date",
        snapshotHint: "Leave empty to use the latest available snapshot",
        preview: "Preview",
        run: "Generate snapshot",
        empty: "No decision snapshot yet",
        source: "Source",
        status: "Status",
        sourcePreview: "Preview",
        sourceLatest: "Latest snapshot",
        asOf: "Data as-of",
        scoreDate: "Score date",
        activeCount: "Tradable symbols",
        selectedCount: "Selected",
        filteredCount: "Filtered",
        riskOff: "Risk gate",
        riskOffReason: "Risk reason",
        cashWeight: "Cash weight",
        maxExposure: "Max exposure",
        scorePath: "Score file",
        filterStats: "Filter breakdown",
        tabSelected: "Selected",
        tabFiltered: "Filtered",
        loadError: "Failed to load decision snapshot",
        previewReady: "Preview ready",
        previewError: "Preview failed",
        runQueued: "Decision snapshot queued",
        runError: "Failed to run snapshot",
        table: {
          rank: "Rank",
          symbol: "Symbol",
          score: "Score",
          weight: "Weight",
          theme: "Theme",
          reason: "Reason",
          empty: "No results",
        },
      },
      pipeline: {
        title: "Training/Backtest Pipeline",
        meta: "Link training quality and backtest performance for ranking",
        link: "Link pipeline",
        linkNone: "No pipeline",
        linkHint: "Use a pipeline to group training and backtests",
        autoCreate: "Auto-create pipeline for training",
        name: "Pipeline Name",
        nameHint: "Optional, e.g. 8Y-LGBM-2024Q4",
        notes: "Notes",
        notesHint: "Optional, describe parameter changes",
        sort: "Sort",
        sortIdDesc: "ID (desc)",
        sortCombined: "Combined Score (desc)",
        sortTrain: "Training Score (desc)",
        sortBacktest: "Backtest Score (desc)",
        sortCreated: "Created (asc)",
        current: "Current Pipeline",
        none: "None",
        create: "Create Pipeline",
        created: "Pipeline created",
        error: "Pipeline action failed",
        untitled: "Untitled",
        active: "Active",
        detail: "Detail",
        use: "Set Current",
        empty: "No pipelines yet",
        table: {
          id: "ID",
          name: "Name",
          trainScore: "Train Score",
          backtestScore: "Backtest Score",
          combinedScore: "Combined Score",
          trainCount: "Train Jobs",
          backtestCount: "Backtests",
          createdAt: "Created At",
          actions: "Actions",
        },
        detailTitle: "Pipeline Detail",
        detailTrainScore: "Best Train Score",
        detailBacktestScore: "Best Backtest Score",
        detailCombinedScore: "Combined Score",
        trainListTitle: "Training Jobs",
        trainTable: {
          id: "ID",
          param: "Param ({param})",
          status: "Status",
          quality: "Quality",
          ndcg10: "NDCG@10",
          ndcg50: "NDCG@50",
          ndcg100: "NDCG@100",
          ic: "IC",
          rankIc: "RankIC",
          curveGap: "Curve Gap",
          createdAt: "Created At",
          actions: "Actions",
          backtest: "Backtest with this train",
        },
        trainEmpty: "No training jobs yet",
        backtestListTitle: "Backtests",
        backtestTable: {
          id: "ID",
          trainId: "Train ID",
          status: "Status",
          cagr: "CAGR",
          sharpe: "Sharpe",
          drawdown: "Drawdown",
          turnover: "Turnover",
          score: "Score",
          createdAt: "Created At",
        },
        backtestEmpty: "No backtests yet",
        backtest: {
          title: "Backtest Parameters",
          meta: "Pipeline backtests use these defaults unless overridden",
          draftStatus: "Draft Status",
          draftSaved: "Saved",
          draftDirty: "Edited, not saved",
          trainJob: "Training Model",
          trainJobAuto: "Auto (not specified)",
          trainJobHint: "Bind backtests to a training job (scores file).",
          trainJobScorePath: "Scores path: {path}",
          preset: "Exposure Preset",
          presetHint: "E35/E45 fill max_exposure; tweak as needed",
          presetE35: "E35 (max_exposure=0.35)",
          presetE45: "E45 (max_exposure=0.45)",
          presetCustom: "Custom",
          applyE35: "Apply E35",
          applyE45: "Apply E45",
          target: "Editing",
          noTarget: "Select a pipeline first",
          save: "Save Backtest Params",
          saved: "Backtest params saved",
          saveError: "Failed to save backtest params",
          runWithSave: "Save & Run Backtest",
          runOnce: "Run Once",
          runQueued: "Backtest queued",
          runError: "Failed to queue backtest",
          runMissingPipeline: "Select a pipeline first",
          runQueuedBatch: "Queued {count} backtests",
          runNoTrainJobs: "No successful train jobs in the current pipeline",
          summary: "Backtest Params",
          empty: "No backtest params",
          fields: {
            topN: "Top N",
            weighting: "Weighting",
            maxWeight: "Max Weight",
            minScore: "Min Score",
            maxExposure: "Max Exposure",
            scoreDelay: "Score Delay (days)",
            scoreSmoothingAlpha: "Score Smoothing Alpha",
            scoreSmoothingCarry: "Carry Missing Scores",
            retainTopN: "Retain Top N",
            marketFilter: "Market Filter",
            marketMa: "Market MA Window",
            riskOffMode: "Risk-Off Mode",
            riskOffPick: "Defensive Selector",
            riskOffSymbols: "Defensive Basket",
            riskOffSymbol: "Defensive Symbol",
            maxDrawdown: "Max Drawdown",
            maxDrawdown52w: "Max Drawdown (52w)",
            drawdownRecovery: "Recovery Threshold",
            drawdownExposureFloor: "Drawdown Exposure Floor",
            drawdownTiers: "Drawdown Tiers",
            drawdownExposures: "Tier Exposures",
            maxTurnoverWeek: "Max Turnover (week)",
            volTarget: "Vol Target",
            volWindow: "Vol Window",
            idleAllocation: "Idle Allocation",
            dynamicExposure: "Dynamic Exposure",
            rebalanceFreq: "Rebalance Frequency",
            rebalanceDay: "Rebalance Day",
            rebalanceTime: "Rebalance Time (min)",
          },
          hints: {
            topN: "Number of holdings per rebalance",
            weighting: "Score-weighted or equal-weighted",
            maxWeight: "Cap single position weight",
            minScore: "Filter out low-score names",
            maxExposure: "Total exposure cap (E35/E45 = 0.35/0.45)",
            scoreDelay: "Delay score usage to avoid look-ahead",
            scoreSmoothingAlpha: "EMA smoothing to reduce noise",
            scoreSmoothingCarry: "Carry forward missing scores",
            retainTopN: "Keep existing holdings beyond Top N",
            marketFilter: "Use benchmark MA to filter risk",
            marketMa: "MA window for market filter",
            riskOffMode: "Risk-off allocation mode",
            riskOffPick: "Selection method for defensive assets",
            riskOffSymbols: "Assets used to pick defensive holdings",
            riskOffSymbol: "Defensive asset when risk-off",
            maxDrawdown: "Hard drawdown gate",
            maxDrawdown52w: "52-week drawdown gate",
            drawdownRecovery: "Recovery threshold ratio",
            drawdownExposureFloor: "Minimum exposure during drawdown",
            drawdownTiers: "CSV, e.g. 0.08,0.12",
            drawdownExposures: "Exposure for each tier",
            maxTurnoverWeek: "Weekly turnover cap",
            volTarget: "Target volatility cap",
            volWindow: "Volatility lookback window (days)",
            idleAllocation: "Allocate idle cash to defensive/benchmark",
            dynamicExposure: "Scale exposure by vol target",
            rebalanceFreq: "Daily/weekly/monthly/quarterly",
            rebalanceDay: "Day of week for rebalance",
            rebalanceTime: "Minutes after open",
          },
          options: {
            weightingScore: "Score",
            weightingEqual: "Equal",
            riskOffCash: "Cash",
            riskOffBenchmark: "Benchmark",
            riskOffDefensive: "Defensive Basket",
            riskOffPickLowestVol: "Lowest Volatility",
            riskOffPickBestMomentum: "Best Momentum",
            idleNone: "None",
            idleDefensive: "Defensive",
            idleBenchmark: "Benchmark",
            rebalanceDaily: "Daily",
            rebalanceWeekly: "Weekly",
            rebalanceMonthly: "Monthly",
            rebalanceQuarterly: "Quarterly",
          },
        },
      },
      backtest: {
        title: "Project Backtest",
        meta: "Run the project algorithm with Lean",
        defaults: {
          title: "Backtest Defaults",
          meta: "Default parameters applied when running backtests",
          empty: "No defaults configured",
          topN: "Top N",
          weighting: "Weighting",
          maxWeight: "Max Weight",
          maxExposure: "Max Exposure",
          minScore: "Min Score",
          marketFilter: "Market Filter",
          marketMa: "Market MA Window",
          riskOff: "Risk-Off Mode",
          rebalanceFreq: "Rebalance Frequency",
          rebalanceDay: "Rebalance Day",
          rebalanceTime: "Rebalance Minutes",
          scoreDelay: "Score Delay (days)",
          reloadScores: "Reload Scores",
        },
        plugins: {
          title: "Strategy Plugins",
          meta: "Configurable backtest plugins for comparisons",
          scoreDelay: "Score Delay (days)",
          scoreDelayHint: "Delay score usage to avoid look-ahead",
          scoreSmoothing: "Score Smoothing",
          scoreSmoothingHint: "EMA smoothing reduces noise",
          scoreSmoothMethod: "Smoothing Method",
          scoreSmoothEma: "EMA",
          scoreSmoothNone: "None",
          scoreSmoothAlpha: "Smoothing Alpha",
          scoreCarry: "Carry Missing Scores",
          scoreHysteresis: "Holding Buffer",
          scoreRetain: "Retain Threshold",
          scoreRetainHint: "Retain existing holdings above Top N",
          weightSmoothing: "Weight Smoothing",
          weightAlpha: "Weight Smooth Alpha",
          riskControl: "Risk Control",
          riskControlHint: "Use benchmark MA to control exposure",
          marketMa: "Market MA Window",
          riskOffMode: "Risk-Off Mode",
          riskOffCash: "Cash",
          riskOffBenchmark: "Benchmark",
          maxExposure: "Max Exposure",
          feeBps: "Fee (bps)",
          slippageBps: "Slippage (bps)",
          impactBps: "Impact (bps)",
        },
        benchmarkTitle: "Benchmark",
        benchmarkMeta: "Set the benchmark for project backtests (default SPY)",
        action: "Run Backtest",
        queued: "Backtest queued",
        empty: "No backtest result",
        error: "Backtest trigger failed",
        failed: "Backtest failed: {message}",
        priceMode: "Price mode",
        benchmarkMode: "Benchmark price",
        pricePolicy: "Price policy",
        trainJob: "Train Job",
        scorePath: "Scores path",
        missingScoresTitle: "Missing scores ({count})",
        priceAdjusted: "Adjusted",
        priceRaw: "Raw",
        priceMixed: "Mixed",
        policyAdjusted: "Adjusted",
        policyRaw: "Raw",
        metric: "Metric",
        portfolio: "Portfolio",
        benchmark: "Benchmark",
        metrics: {
          cagr: "CAGR",
          volatility: "Volatility",
          sharpe: "Sharpe",
          maxDrawdown: "Max Drawdown",
        },
      },
      automation: {
        title: "Weekly Automation",
        meta: "Refresh PIT weekly snapshot → fundamentals → thematic backtest",
        action: "Run Now",
        running: "Running",
        queued: "Automation queued",
        empty: "No automation runs yet",
        error: "Automation trigger failed",
        statusLabel: "Status",
        pitWeekly: "PIT Weekly Job",
        pitWeeklyLog: "PIT Weekly Log",
        pitFund: "PIT Fundamental Job",
        pitFundLog: "PIT Fundamental Log",
        backtest: "Backtest Status",
        backtestLog: "Backtest Log",
        backtestOutput: "Backtest Output",
        backtestArtifact: "Backtest Artifact",
        log: "Automation Log",
        status: {
          queued: "Queued",
          running: "Running",
          cancel_requested: "Canceling",
          canceled: "Canceled",
          success: "Success",
          failed: "Failed",
          unknown: "Unknown",
        },
      },
      versions: {
        title: "Version Management",
        meta: "Capture project notes or configuration snapshots.",
        emptyProject: "No projects yet",
        version: "Version (v0.1)",
        description: "Version Notes",
        content: "Content snapshot (default: {description})",
        errorSelect: "Select a project first.",
        errorContent: "Provide a version or content snapshot.",
      },
      diff: {
        title: "Version Diff",
        meta: "Select two versions to compare.",
        selectFrom: "Select base version",
        selectTo: "Select target version",
        errorSelect: "Select two versions to compare.",
        empty: "No differences",
        none: "No diff generated yet",
      },
      versionsTable: {
        id: "Version ID",
        version: "Version",
        summary: "Summary",
        hash: "Hash",
        createdAt: "Created At",
        empty: "No versions yet",
        unnamed: "Unnamed",
      },
    },
    themes: {
      title: "Theme Studio",
      project: {
        title: "Project Scope",
        meta: "Select a project to manage themes",
        select: "Active Project",
        name: "Project Name",
        description: "Description",
        configSource: "Config Source",
        empty: "Select a project to continue",
      },
      config: {
        title: "Theme Configuration",
        meta: "Manage weights, keywords, and manual symbols",
      },
      composition: {
        title: "Theme Composition",
        meta: "Review coverage and constituent symbols",
      },
      compare: {
        meta: "Compare overlaps and deltas",
      },
    },
    algorithms: {
      title: "Algorithm Management",
      register: {
        title: "Register Algorithm",
        meta: "Manage strategy versions and execution entrypoints.",
        name: "Algorithm Name",
        description: "Description",
        language: "Language (Python/CSharp)",
        version: "Version (v1.0.0)",
        path: "Algorithm file path (/app/stocklean/algorithms/xxx.py)",
        typeName: "C# type name (optional)",
        errorName: "Algorithm name is required.",
      },
      overview: {
        title: "Algorithm Overview",
        meta: "Total registered",
      },
      list: {
        title: "Algorithm List",
        meta: "Find and filter algorithms",
        search: "Search algorithm name",
        empty: "No algorithms yet",
      },
      detail: {
        title: "Algorithm Details",
        meta: "Edit metadata and review version stats",
        latest: "Latest #{id}",
        versions: "Versions {count}",
        name: "Algorithm name",
        description: "Description",
        language: "Language",
        version: "Default version",
        path: "File path",
        typeName: "Type name",
        empty: "Select an algorithm first",
        error: "Save failed. Try again.",
      },
      tabs: {
        params: "Parameters",
        versions: "Versions",
        diff: "Diff",
        project: "Project",
        selftest: "Self Test",
      },
      selftest: {
        title: "Algorithm Self Test",
        meta: "Run a Lean backtest and compare against a benchmark",
        version: "Algorithm version",
        benchmark: "Benchmark",
        hint: "Suggested: SPY, QQQ, VTI, IWM, DIA. Custom symbols supported.",
        action: "Run self test",
        running: "Running...",
        queued: "Backtest queued, ID {id}",
        lastRun: "Latest run ID {id}",
        viewReports: "View reports",
        error: "Backtest failed to start",
        errorSelect: "Select an algorithm version",
      },
      params: {
        title: "Algorithm Parameters",
        meta: "Weekly rotation and risk controls",
        cadence: "Rebalance cadence",
        weekly: "Weekly",
        monthly: "Monthly",
        market: "Market",
        us: "US",
        assetClass: "Asset class",
        equity: "Equity",
        allowEtf: "Allow ETFs",
        coreTitle: "Core allocation",
        coreSymbols: "Core symbols (comma separated)",
        coreWeight: "Core weight",
        coreFallback: "Missing handling",
        cash: "Hold cash",
        redistribute: "Redistribute to core",
        themeTitle: "Theme weights",
        themeKey: "Theme key",
        themeWeight: "Weight",
        themeAdd: "Add theme weight",
        themeRemove: "Remove",
        themeEmpty: "No theme weights yet. Add one to begin.",
        themeOptionHint: "Type a theme key or pick from system themes",
        selectionTitle: "Selection parameters",
        topN: "Top N per theme",
        topMomentum: "Top momentum",
        topLowVol: "Top low-vol",
        minPositions: "Minimum positions",
        trendWeeks: "Trend window (weeks)",
        riskOnWeeks: "Risk-on MA (weeks)",
        lowvolDays: "Low-vol window (days)",
        momShortDays: "Short momentum (days)",
        momLongDays: "Long momentum (days)",
        mom12w: "12w momentum weight",
        mom4w: "4w momentum weight",
        vol20d: "20d volatility penalty",
        blendTitle: "Momentum/low-vol blend",
        momentumWeight: "Momentum weight",
        lowvolWeight: "Low-vol weight",
        riskTitle: "Risk controls",
        maxWeight: "Max position",
        volTarget: "Volatility target",
        drawdown: "Drawdown trigger",
        inverseVol: "Inverse volatility weighting",
        minVol: "Minimum volatility",
        themeTilt: "Theme tilt",
        defensiveTitle: "Defensive assets",
        defensiveSymbols: "Defensive symbols (comma-separated)",
        defensiveHint: "Rotate into defensive assets when risk is off",
        advancedTitle: "Advanced parameters",
        advancedHint: "Used by composite/low-vol strategies",
        coreEnable: "Enable core allocation",
        coreDisabledHint: "New algorithms default to no core allocation",
        modeForm: "Structured",
        modeJson: "JSON",
        modeHint: "Use JSON mode for algorithms that don't match the form",
        jsonTitle: "Parameters JSON",
        jsonPlaceholder: "{\n  \"selection\": {\n    \"top_n\": 20\n  }\n}",
        jsonHint: "Version will be saved with the JSON above",
        jsonError: "Invalid JSON parameters",
        notes: "Notes",
        reset: "Reset",
        saveVersion: "Save as version",
      },
      table: {
        name: "Name",
        language: "Language",
        version: "Version",
        path: "Path",
        updatedAt: "Updated At",
      },
      versions: {
        title: "Version Management",
        meta: "Capture algorithm snapshots and diffs.",
        empty: "No algorithms yet",
        pick: "Select a version",
        version: "Version (v1.0.1)",
        description: "Version Notes",
        language: "Language (default {language})",
        typeName: "C# type name (optional)",
        filePath: "Algorithm file path (leave empty to use content)",
        content: "Algorithm content (optional, for diff)",
        errorSelect: "Select an algorithm first.",
        errorContent: "Provide a version, file path/content, or parameters.",
      },
      projectCreate: {
        title: "Create Project",
        meta: "Use a version as a project template.",
        name: "Project name",
        description: "Project description",
        version: "Algorithm version",
        lock: "Lock version",
        action: "Create project",
        success: "Project created and bound",
        error: "Create failed. Check inputs.",
        errorSelect: "Select an algorithm version",
      },
      diff: {
        title: "Version Diff",
        meta: "Select two versions to compare.",
        selectFrom: "Select base version",
        selectTo: "Select target version",
        errorSelect: "Select two versions to compare.",
        empty: "No differences",
        none: "No diff generated yet",
        unnamed: "Unnamed",
      
      actions: {
        viewCharts: "Charts",
        viewTrades: "Trades",
      },
},
      versionsTable: {
        id: "Version ID",
        version: "Version",
        summary: "Summary",
        hash: "Hash",
        createdAt: "Created At",
        empty: "No versions yet",
      },
    },
    backtests: {
      title: "Backtest Center",
      tabs: {
        runs: "Backtests",
        reports: "Reports",
      },
      actions: {
        viewCharts: "Charts",
        viewTrades: "Trades",
      },
      launch: {
        title: "Launch Backtest",
        meta: "Provide project ID and parameters.",
        projectId: "Project ID",
        params: "Parameters JSON",
      },
      table: {
        id: "ID",
        project: "Project",
        status: "Status",
        progress: "Progress",
        range: "Range",
        report: "Report",
        actions: "Actions",
        createdAt: "Created At",
        endedAt: "Ended At",
      },
      preview: {
        title: "Backtest Charts",
        meta: "Click a backtest to view performance and trade charts.",
        empty: "Select a backtest to view charts.",
        charts: "Equity & Drawdown",
        trades: "Trade Chart",
      },
    },
    reports: {
      title: "Report Center",
      latest: {
        title: "Latest Reports",
        meta: "Auto-archived after backtest runs.",
      },
      preview: {
        title: "Report Preview",
        meta: "View backtest HTML report inline.",
        open: "Open in new tab",
        empty: "Select a report to preview.",
      },
      risk: {
        title: "Corporate Actions Risk",
        meta:
          "Adjustments and ticker mapping rely on map_files/factor_files. Missing data can break price history and distort backtests.",
      },
      compare: {
        title: "Backtest Comparison",
        meta: "Enter multiple backtest IDs to compare key metrics.",
        placeholder: "e.g. 2, 15, 18",
        error: "Comparison failed",
        empty: "Enter backtest IDs (comma or space separated).",
      },
      charts: {
        title: "Chart Preview",
        meta: "Enter a backtest ID to load equity and drawdown curves.",
        placeholder: "Backtest ID",
        errorNotFound: "Result file not found. Ensure the backtest finished.",
        errorLoad: "Failed to load chart data",
      },
        trades: {
          title: "Trade Chart",
          meta: "Overlay fills and price action for quick trade review.",
          placeholder: "Backtest ID",
          symbolPlaceholder: "Symbol",
          load: "Load Trade Chart",
          loading: "Loading trade data...",
          error: "Failed to load trade chart",
          empty: "No trades or missing price data.",
          buy: "Buy",
          buyShort: "B",
          sell: "Sell",
          sellShort: "S",
          tradesCount: "{count} trades",
          summary: "Buy {buys} / Sell {sells} · Win {wins} / Loss {losses}",
          table: {
            time: "Time",
            side: "Side",
            qty: "Qty",
            price: "Price",
          },
        },
      table: {
        id: "ID",
        runId: "Backtest ID",
        type: "Type",
        path: "Path",
        actions: "Actions",
        createdAt: "Created At",
      },
    },
    data: {
      title: "Data Management",
      coverage: {
        title: "Coverage",
        meta: "Data sync and quality monitoring.",
      },
      liveTrade: {
        title: "Live Trading Entry",
        meta: "IB live trading settings moved to Live Trading page.",
        hint: "Manage live data and execution settings in Live Trading.",
        open: "Open Live Trading",
      },
      lifecycle: {
        title: "Lifecycle Overrides",
        meta: "Use overrides when delist dates conflict with price history.",
        source: "Default lifecycle file:",
        override: "Override file:",
        priority: "Overrides take priority over Alpha lifecycle.",
        config: "Override path config:",
      },
      fetch: {
        title: "Fetch History",
        meta: "Default to Alpha. Daily only.",
        symbol: "Symbol (e.g., AAPL)",
        vendor: {
          stooq: "Stooq",
          yahoo: "Yahoo",
          alpha: "Alpha Vantage (default)",
        },
        stooqOnly: "Alpha only",
        region: {
          us: "US",
          hk: "HK",
        },
        asset: {
          equity: "Equity",
          etf: "ETF",
        },
        frequency: {
          daily: "Daily",
          minute: "Minute (unsupported)",
        },
        preview: "Dataset {dataset} · Source {source}",
        action: "Fetch History",
        loading: "Fetching",
        hint: "Alpha supports daily data only; a sync job will be queued.",
        errorSymbol: "Symbol is required.",
        errorFrequency: "Daily data only for the selected vendor.",
        error: "Fetch failed.",
        successCreated: "Created {name}, sync job #{jobId} queued.",
        successQueued: "Reused {name}, sync job #{jobId} queued.",
        successNoJob: "Dataset {name} ready.",
      },
      list: {
        title: "Datasets",
        meta: "Filtered {totalSymbols} symbols / {totalDatasets} datasets · Daily/Minute supported",
        stooqOnly: "Alpha only",
        empty: "No datasets",
        filter: {
          label: "Frequency",
          all: "All",
          daily: "Daily",
          minute: "Minute",
        },
        theme: {
          label: "Theme",
          all: "All Themes",
          loading: "Loading",
          error: "Failed to load themes",
          coverageTitle: "Theme Coverage · {theme}",
          coverageMeta: "{covered}/{total} covered · {missing} missing",
          coverageSample: "Missing sample: {symbols}",
          coverageEmpty: "No theme coverage available",
          coverageError: "Failed to load theme coverage",
          fetch: "Fetch missing constituents",
          fetching: "Filling",
          fetchSuccess: "Created {created} datasets, queued {queued} sync jobs",
          fetchError: "Fill failed",
          confirm: "Fetch {count} missing constituents for this theme?",
          noMissing: "All constituents are covered",
        },
        update: {
          sync: "Sync",
          syncing: "Syncing",
          syncAll: "Sync All",
          syncingAll: "Syncing",
          reset: "Full rerun (clear & refetch)",
          resetConfirm: "This will clear local history and refetch all data. Continue?",
        },
        chart: {
          show: "Chart",
          hide: "Hide Chart",
        },
        delete: {
          action: "Delete",
          deleting: "Deleting",
          confirm: "Delete all data for {symbol}? This cannot be undone.",
          prompt: "Type {symbol} to confirm deletion",
          mismatch: "Input does not match. Deletion cancelled.",
          error: "Delete failed",
        },
        quality: {
          loading: "Loading",
          error: "Quality error",
          incomplete: "Incomplete",
          days: "d",
          issues: "Issues {count}",
        },
        table: {
          symbol: "Symbol",
          name: "Name",
          periods: "Periods",
          frequency: "Frequency",
          coverage: "Coverage",
          updatedAt: "Updated",
          source: "Source",
          quality: "Quality",
          update: "Update",
          actions: "Actions",
        },
      },
      pretrade: {
        title: "PreTrade Checklist",
        meta: "Weekly pre-open data sync orchestration and fallback",
        projectSelect: "Select project",
        projectRequired: "Select a project first",
        projectLoadError: "Failed to load projects",
        templateAuto: "Use current template / default steps",
        templateNameRequired: "Template name is required",
        templateParseError: "Template params JSON is invalid",
        templateLoadError: "Failed to load templates",
        templateCreateError: "Failed to create template",
        templateActivateError: "Failed to activate template",
        runCreated: "Run #{id} created",
        runLoadError: "Failed to load runs",
        runDetailError: "Failed to load run details",
        runCreateError: "Failed to create run",
        runCancelError: "Failed to cancel run",
        runResumeError: "Failed to resume run",
        stepRetryError: "Failed to retry step",
        settingsSaved: "Settings saved",
        settingsLoadError: "Failed to load settings",
        settingsSaveError: "Failed to save settings",
        summaryLine: "Run #{id} · {status}",
        summaryProgress: "Done {done}/{total} · {percent}%",
        summaryDeadline: "Deadline {at}",
        summaryWindow: "Window {start} ~ {end}",
        summaryFallback: "Fallback to run #{id}",
        summaryEmpty: "No runs yet",
        windowStart: "Window start date",
        windowEnd: "Window end date",
        run: {
          title: "Start Checklist",
          action: "Start Run",
          note: "Only one run at a time",
        },
        history: {
          title: "Run History",
          empty: "No runs",
          id: "ID",
          status: "Status",
          window: "Window",
          actions: "Actions",
          view: "View",
          cancel: "Cancel",
          canceling: "Canceling",
          resume: "Resume",
          resuming: "Resuming",
        },
        steps: {
          title: "Steps",
          empty: "No steps",
          name: "Step",
          status: "Status",
          progress: "Progress",
          updatedAt: "Updated",
          message: "Message",
          actions: "Actions",
          retry: "Retry",
          retrying: "Retrying",
          nextRetry: "Next retry {at}",
          logPath: "Log {path}",
          calendar_refresh: "Calendar refresh",
          trading_day_check: "Trading day check",
          price_incremental: "Price incremental sync",
          listing_refresh: "Listing refresh",
          fundamentals_refresh: "Fundamentals cache refresh",
          pit_weekly: "PIT weekly snapshot",
          pit_fundamentals: "PIT fundamentals snapshot",
          training_scoring: "Training/Scoring",
          decision_snapshot: "Decision snapshot",
          audit: "Audit check",
        },
        stepsDesc: {
          calendar_refresh: "Refresh trading calendar and holidays",
          trading_day_check: "Validate trading windows and sessions",
          price_incremental: "Incremental price sync",
          listing_refresh: "Refresh Alpha listing and lifecycle",
          fundamentals_refresh: "Refresh Alpha fundamentals cache only",
          pit_weekly: "Generate PIT weekly universe snapshot",
          pit_fundamentals: "Build PIT fundamentals using PIT + cache",
          training_scoring: "Training/scoring (optional)",
          decision_snapshot: "Generate model decision snapshot",
          audit: "Coverage and audit checks",
        },
        stepsGroup: {
          data: "Data prep",
          dataHint: "Prices, listing, and fundamentals cache",
          pit: "PIT snapshots",
          pitHint: "Depends on weekly snapshot + fundamentals cache",
          model: "Model & audit",
          modelHint: "Training, decision, and audits",
          other: "Other steps",
          otherHint: "Extra steps in template",
        },
        settings: {
          title: "Notifications & Retry",
          token: "Telegram Bot Token",
          tokenHint: "Saved: {token}",
          chatId: "Telegram Chat ID",
          chatIdHint: "Saved: {chatId}",
          maxRetries: "Max retries",
          retryBase: "Retry base (sec)",
          retryMax: "Retry max (sec)",
          deadlineTime: "Deadline time (HH:MM)",
          deadlineTimezone: "Time zone",
          projectOnly: "Update project symbols only",
          projectOnlyHint:
            "When enabled, update symbols from active, non-archived projects only (prices & fundamentals).",
          autoDecision: "Auto-generate decision snapshot after checklist",
          autoDecisionHint: "Create a model decision snapshot at the end of checklist runs.",
          note: "Leave token/chat_id empty to keep current config",
        },
        telegram: {
          test: "Send test notification",
          testMessage: "PreTrade checklist test",
          testOk: "Test message sent",
          testError: "Failed to send test",
        },
        templates: {
          title: "Checklist Templates",
          id: "ID",
          name: "Name",
          params: "Params (JSON)",
          create: "Create template",
          createError: "Failed to create template",
          activate: "Set active",
          activating: "Activating",
          active: "Active",
          activeTag: "Active",
          actions: "Actions",
          hint: "Select steps to build a template; use advanced JSON only when needed",
          editing: "Editing template #{id}",
          stepsTitle: "Step selection",
          selectAll: "Select all",
          clearAll: "Clear all",
          reset: "Reset default",
          useAdvanced: "Use advanced JSON to override steps",
          advancedHint: "When enabled, advanced JSON takes precedence over the checklist",
          preview: "Preview",
          update: "Save update",
          cancelEdit: "Cancel edit",
          details: "Details",
          edit: "Load editor",
          stepsSummary: "Steps",
          stepsCount: "{enabled}/{total} enabled",
          detailTitle: "Template detail #{id}",
          paramsPreview: "Params JSON",
          noSteps: "No steps",
          delete: "Delete",
          deleteConfirm: "Delete this template? This action cannot be undone.",
          deleteError: "Failed to delete template",
          empty: "No templates",
        },
      },
      bulk: {
        title: "Bulk Fetch (All US)",
        meta: "Batch create datasets from Alpha listing and enqueue sync jobs",
        autoTitle: "One-click: refresh listing → enqueue → auto fetch",
        autoAction: "Start One-click Bulk Fetch",
        autoLoading: "Starting bulk fetch",
        autoHint: "Refreshes listing, batches datasets, then starts the queue",
        autoNote: "Runs in background; refresh to see progress",
        autoStatus: "Job #{id} · status {status} · phase {phase}",
        autoCounts: "Created {created} · Reused {reused} · Queued {queued} · Running {running} · Pending {pending}",
        auto: {
          batch: "Auto batch size (e.g., 200)",
          delay: "Fetch delay seconds (e.g., 0.1)",
        },
        gap: {
          title: "Alpha Coverage Gap",
          latestComplete: "Latest trading day {date}",
          total: "Total {count}",
          withCoverage: "With coverage {count}",
          missingCoverage: "Missing coverage {count}",
          upToDate: "Up-to-date {count}",
          bucket0_30: "Gap 0-30d {count}",
          bucket31_120: "Gap 31-120d {count}",
          bucket120Plus: "Gap 120+d {count}",
          listingAge: "Listing age {days} days",
          loadError: "Failed to load gap summary",
        },
        listing: {
          title: "Listing Refresh Policy",
          modeAlways: "Always refresh",
          modeStale: "Refresh if stale",
          modeNever: "Never refresh",
          ttlDays: "Stale TTL (days)",
          hint: "Policy applies to listing refresh before this bulk job",
        },
        incremental: {
          title: "Incremental Strategy (Global)",
          enabled: "Enable incremental fetch",
          compactDays: "Compact threshold days (e.g., 120)",
          hint: "Use compact if gap ≤ threshold, otherwise full",
          note: "Global setting; applies to bulk and single sync",
          saved: "Incremental strategy saved",
          loadError: "Failed to load incremental strategy",
          saveError: "Failed to save incremental strategy",
        },
        defaults: {
          note: "Save bulk defaults (listing + incremental)",
          saved: "Bulk defaults saved",
          loadError: "Failed to load bulk defaults",
          saveError: "Failed to save bulk defaults",
        },
        autoError: "Failed to load bulk sync status",
        actionError: "Action failed",
        errorDetail: "Error: {detail}",
        statusLabel: {
          queued: "Queued",
          running: "Running",
          paused: "Paused",
          success: "Success",
          failed: "Failed",
          canceled: "Canceled",
        },
        phaseLabel: {
          listing_refresh: "Listing refresh",
          enqueue: "Enqueue",
          syncing: "Syncing",
          done: "Done",
          canceled: "Canceled",
          paused: "Paused",
        },
        actions: {
          pause: "Pause",
          resume: "Resume",
          cancel: "Cancel",
        },
        history: {
          title: "History",
          empty: "No history",
          id: "ID",
          status: "Status",
          phase: "Phase",
          progress: "Progress",
          counts: "Counts",
          error: "Error",
          updatedAt: "Updated",
          actions: "Actions",
          progressValue: "{processed}/{total}",
          countsValue: "Created {created} · Reused {reused} · Queued {queued}",
        },
        step1: "Step 1: batch create + enqueue (no auto fetch)",
        step2: "Step 2: start the queue to fetch",
        status: {
          all: "All",
          active: "Active only",
          delisted: "Delisted only",
        },
        limit: "Batch size (e.g., 200)",
        offset: "Offset (e.g., 0)",
        batchHint: "Batch size = symbols per run; Offset = start index",
        offsetHint: "Use the next offset to avoid duplicates",
        onlyMissing: "Only create missing datasets",
        projectOnly: "Project symbols only",
        projectOnlyHint: "When enabled, only active, non-archived project symbols are fetched.",
        autoSync: "Auto enqueue sync jobs",
        action: "Create & Enqueue",
        loading: "Working",
        hint: "Run in batches, then start the queue below",
        result: "Created {created} · Reused {reused} · Queued {queued} · Total {total} · Next {next}",
        progress: "Progress {processed}/{total} ({percent}%)",
        applyNext: "Apply next offset ({next})",
        error: "Failed to create bulk fetch jobs",
        queueError: "Failed to start queue",
        queue: {
          maxJobs: "Jobs this run (0 = all)",
          minDelay: "Delay between jobs (e.g., 0.1s)",
          hint: "Queue runs sequentially; speed depends on rate limits",
          action: "Start Queue",
          loading: "Starting queue",
          result: "{started} · Pending {pending}",
          started: "Queue started",
          already: "Queue already running",
        },
      },
      pit: {
        title: "PIT Weekly Snapshots",
        meta: "Rebalance on week open, snapshot previous trading close",
        start: "Start date",
        end: "End date",
        requireData: "Only include symbols with data",
        action: "Generate weekly snapshots",
        loading: "Generating",
        note: "Outputs to universe/pit_weekly for weekly rebalancing",
        latest: "Latest job #{id} · status {status}",
        calendar: "Timezone {tz} · Session {session}",
        qualityError: "Failed to load quality report",
        progressError: "Progress load failed",
        quality: {
          snapshots: "Snapshots {count}",
          symbols: "Symbols {count}",
          fixed: "Fixed {count}",
          dup: "Duplicates {count}",
          invalid: "Invalid {count}",
          mismatch: "Date mismatch {count}",
          life: "Out of life {count}",
          noData: "No data {count}",
          updated: "Updated {at}",
        },
        progress: {
          stage: "Stage {stage}",
          status: "Status {status}",
          count: "Snapshots {count}",
          updated: "Updated {at}",
        },
        snapshotCount: "Snapshots {count}",
        lastSnapshot: "Latest snapshot {path}",
        output: "Output {path}",
        log: "Log {path}",
        historyTitle: "Recent jobs",
        historyEmpty: "No jobs yet",
        loadError: "Failed to load PIT weekly jobs",
        error: "Failed to create PIT weekly job",
        created: "Created job #{id}",
        history: {
          id: "ID",
          status: "Status",
          count: "Snapshots",
        },
      },
      pitFund: {
        title: "PIT Fundamental Snapshots",
        meta: "Separate fundamentals cache fetch from PIT weekly snapshots",
        start: "Start date",
        end: "End date",
        startHint: "Only process PIT weekly snapshots after this date",
        endHint: "Only process PIT weekly snapshots before this date",
        cacheSectionTitle: "Fundamentals cache fetch",
        cacheSectionHint: "Refresh Alpha fundamentals cache only (no PIT snapshots).",
        delay: "Report delay (days)",
        delayHint: "Trading-day lookback for report availability",
        missingDelay: "Missing report delay (days)",
        missingDelayHint: "Use fiscalDate + default delay when reportedDate is missing",
        sharesDelay: "Shares delay (days)",
        sharesDelayHint: "Conservative delay for SHARES_OUTSTANDING availability",
        sharesPreference: "Shares preference",
        sharesPreferenceHint: "Choose diluted or basic",
        sharesPreferenceDiluted: "Diluted",
        sharesPreferenceBasic: "Basic",
        priceSource: "Price source",
        priceSourceHint: "Price source for PIT market cap",
        priceSourceRaw: "Raw (curated)",
        priceSourceAdjusted: "Adjusted (curated_adjusted)",
        minDelay: "Fetch delay (seconds)",
        minDelayHint: "Delay per request; lower is faster but hits rate limits",
        refreshDays: "Cache refresh days (0=force refresh)",
        refreshDaysHint: "0 forces refresh regardless of cache age",
        assetTypes: "Asset type filter",
        assetTypesHint: "Comma-separated, e.g. STOCK; leave blank or ALL to disable",
        cacheAction: "Refresh fundamentals cache",
        cacheLoading: "Refreshing",
        cacheNote: "Outputs to fundamentals/alpha",
        snapshotSectionTitle: "PIT fundamentals snapshots",
        snapshotSectionHint: "Build weekly snapshots from cached fundamentals",
        projectOnly: "Project symbols only",
        projectOnlyHint: "When enabled, only active, non-archived project symbols are fetched.",
        resume: "Resume",
        resumeHint: "Skip symbols with complete cached fundamentals",
        action: "Generate fundamental snapshots",
        loading: "Generating",
        note: "Outputs to factors/pit_weekly_fundamentals",
        latest: "Latest job #{id} · status {status}",
        latestMode: "Mode {mode}",
        progressError: "Progress load failed",
        mode: {
          cache: "Cache",
          snapshot: "Snapshot",
          both: "Cache + Snapshot",
          none: "Unset",
        },
        progress: {
          stage: "Stage {stage}",
          count: "Progress {done}/{total}",
          ok: "OK {count}",
          partial: "Partial {count}",
          rate: "Rate-limited {count}",
          speed: "Speed {rate}/min · Target {target}/min · Interval {interval}s",
          tune: "Auto tune {reason} → {delay}s",
          current: "Current {symbol}",
          missing: "Missing {count}",
          missingPath: "List {path}",
        },
        snapshotCount: "Snapshots {count}",
        lastSnapshot: "Latest snapshot {path}",
        output: "Output {path}",
        log: "Log {path}",
        historyTitle: "Recent jobs",
        historyEmpty: "No jobs yet",
        loadError: "Failed to load fundamental snapshot jobs",
        error: "Failed to create fundamental snapshot job",
        created: "Created job #{id}",
        cacheCreated: "Created cache job #{id}",
        resumed: "Resume job #{id} created",
        resumeError: "Failed to resume job",
        canceled: "Stop requested for job #{id}",
        cancelError: "Failed to stop job",
        history: {
          id: "ID",
          status: "Status",
          mode: "Mode",
          count: "Snapshots",
          progress: "Progress",
          actions: "Actions",
          resume: "Resume",
          stop: "Stop",
          canceling: "Canceling",
        },
      },
      frequency: {
        daily: "Daily",
        minute: "Minute",
      },
      chart: {
        title: "Dataset Chart",
        meta: "Candles vs Adjusted · {frequency} · {coverage}",
        mode: {
          both: "Compare",
          raw: "Raw",
          adjusted: "Adjusted",
        },
        granularity: {
          auto: "Auto",
          day: "Day",
          week: "Week",
          month: "Month",
        },
        range: {
          max: "Max",
        },
        open: "Open in new tab",
        legend: {
          raw: "Raw price (candles)",
          adjusted: "Adjusted price (line)",
        },
        loading: "Loading chart...",
        empty: "No chart data",
        error: "Failed to load chart",
      },
      table: {
        name: "Name",
        vendor: "Vendor",
        frequency: "Frequency",
        coverage: "Coverage",
        path: "Path",
        quality: "Quality",
        updatedAt: "Updated At",
      },
      quality: {
        error: "Failed to fetch quality report",
        title: "Quality Report",
        status: "Status",
        coverage: "Coverage",
        days: "Coverage Days",
        frequency: "Frequency",
        expected: "Expected Points",
        points: "Data Points",
        minInterval: "Min Interval (days)",
        issues: "Issues",
      },
      scan: {
        title: "Quality Scan (Missing/Anomalies)",
        meta: "Provide a CSV path and run scan.",
        select: "Select Dataset",
        errorSelect: "Select a dataset.",
        filePath: "CSV file path (under DATA_ROOT)",
        errorFilePath: "Provide a data file path.",
        dateColumn: "Date column",
        closeColumn: "Close column",
        frequency: "Frequency (daily/minute)",
        error: "Quality scan failed",
        result: "Scan Results",
        totalRows: "Total rows",
        missingDays: "Missing trading days",
        missingRatio: "Missing ratio",
        nullClose: "Missing close prices",
        duplicate: "Duplicate timestamps",
        outliers: "Outlier returns",
        maxAbs: "Max absolute return",
      },
      sync: {
        title: "Data Sync (Backfill/Incremental)",
        meta: "Scan path and update coverage.",
        path: "Data path (optional, or alpha:SYMBOL)",
        dateColumn: "Date column",
        errorCreate: "Failed to create sync job",
        errorBatch: "Failed to sync all",
        incrementalHint: "Alpha sync mode: {mode} · compact threshold {days} days",
        incremental: {
          enabled: "Incremental",
          disabled: "Full",
        },
      },
      jobs: {
        title: "Sync Jobs",
        meta: "Total {total} jobs",
        speed:
          "Actual {rate}/min · Target {target}/min · Interval {interval}s · last {window}s · running {running} · pending {pending}",
        speedEmpty: "Rate -",
        clear: "Clear Queue",
        clearing: "Clearing",
        clearConfirm: "Clear queued sync jobs? Running jobs will continue.",
        clearDone: "Cleared {count} queued jobs",
        clearError: "Failed to clear queue",
        empty: "No sync jobs",
        retry: "Retries {count} · next {next}",
        elapsed: "Elapsed {value}",
        stage: "Stage {stage}",
        stageProgress: "Stage {stage} · {progress}%",
        id: "ID",
        dataset: "Dataset",
        status: "Status",
        rows: "Rows scanned",
        coverage: "Coverage",
        outputs: "Outputs/Archive",
        message: "Message",
        createdAt: "Created At",
        reason: {
          stooqOnly: "Only {vendor}",
          rateLimited: "Rate limited",
          premium: "Premium required",
          notFound: "Not found",
          failed: "Failed",
        },
        outputLabels: {
          curated: "curated",
          normalized: "normalized",
          adjusted: "adjusted",
          snapshot: "snapshot",
          lean: "lean",
          leanAdjusted: "lean(adj)",
        },
        alpha: {
          outputsize: "alpha={value}",
          gapDays: "gap {value}d",
          fallback: "compact fallback",
        },
        stageLabel: {
          fetch: "Fetch",
          normalize: "Normalize",
          finalize: "Finalize",
        },
      },
      tradingCalendar: {
        title: "Trading Calendar",
        meta: "Calendar source & coverage · Config {path}",
        source: "Config source",
        calendarSource: "Calendar source",
        coverage: "Coverage",
        generatedAt: "Generated at",
        previewTitle: "Trading Day Preview",
        previewAsOf: "As of (ET)",
        previewTimezone: "Timezone",
        latestDay: "Latest trading day",
        nextDay: "Next trading day",
        sessions: "Session count",
        overridesApplied: "Overrides applied",
        weekDays: "This week ({count} days)",
        calendarViewTitle: "Month View",
        prevMonth: "Prev",
        nextMonth: "Next",
        recentDays: "Recent trading days",
        upcomingDays: "Upcoming trading days",
        previewEmpty: "No data",
        configTitle: "Calendar settings",
        sourceMode: "Source mode",
        sourceModeHint: "Priority: auto/local/exchange_calendars/lean/spy",
        exchange: "Exchange",
        exchangeHint: "Default XNYS (NYSE)",
        startDate: "Start date",
        startDateHint: "Calendar start date",
        endDate: "End date",
        endDateHint: "Calendar end date",
        refreshDays: "Refresh window (days)",
        refreshDaysHint: "Refresh the last N days only",
        overrides: "Overrides",
        overridesHint: "Apply temporary halt/special session overrides",
        refresh: "Refresh calendar",
        calendarPath: "Calendar file {path}",
        overridesPath: "Overrides file {path}",
        saved: "Trading calendar config saved",
        refreshed: "Trading calendar refreshed",
        loadError: "Failed to load trading calendar",
        previewError: "Failed to load trading day preview",
        saveError: "Failed to save trading calendar",
        refreshError: "Failed to refresh trading calendar",
        weekdayMon: "Mon",
        weekdayTue: "Tue",
        weekdayWed: "Wed",
        weekdayThu: "Thu",
        weekdayFri: "Fri",
        weekdaySat: "Sat",
        weekdaySun: "Sun",
      },
      alphaRate: {
        title: "Alpha Rate Limits",
        meta: "Control Alpha request rate & auto tuning · Config {path}",
        baseTitle: "Base Rate Limits",
        tuneTitle: "Auto-tune Settings",
        maxRpm: "Max RPM",
        maxRpmHint: "Target requests per minute (max_rpm)",
        minDelay: "Min delay (s)",
        minDelayHint: "Base delay; effective delay is max(min_delay, 60/max_rpm)",
        rateLimitSleep: "Rate-limit sleep (s)",
        rateLimitSleepHint: "Sleep duration after rate-limit responses",
        rateLimitRetries: "Rate-limit retries",
        rateLimitRetriesHint: "Retries per symbol after rate limit",
        maxRetries: "Max retries",
        maxRetriesHint: "Retries per request on failures",
        autoTune: "Auto tune",
        autoTuneHint: "Auto-adjust min_delay based on observed speed",
        rpmFloor: "RPM floor",
        rpmFloorHint: "Do not drop below this RPM on rate limit",
        rpmCeil: "RPM ceiling",
        rpmCeilHint: "Recover up to this RPM",
        rpmStepDown: "RPM step down",
        rpmStepDownHint: "Decrease RPM by this amount when rate limited",
        rpmStepUp: "RPM step up",
        rpmStepUpHint: "Increase RPM when below target",
        minDelayFloor: "Delay floor (s)",
        minDelayFloorHint: "Lower bound for auto tuning",
        minDelayCeil: "Delay ceil (s)",
        minDelayCeilHint: "Upper bound for auto tuning",
        tuneStep: "Tune step (s)",
        tuneStepHint: "Adjustment size per step",
        tuneWindow: "Tune window (s)",
        tuneWindowHint: "Window length for speed measurement",
        tuneLow: "Low ratio",
        tuneLowHint: "Decrease delay when rate < target×ratio",
        tuneHigh: "High ratio",
        tuneHighHint: "Increase delay when rate > target×ratio",
        tuneCooldown: "Tune cooldown (s)",
        tuneCooldownHint: "Minimum gap between adjustments",
        source: "Source",
        effective: "Effective delay",
        saved: "Alpha rate config saved",
        loadError: "Failed to load Alpha rate config",
        saveError: "Failed to save Alpha rate config",
      },
      ib: {
        title: "Brokerage Connection",
        meta: "Configure Lean Bridge connection & market data mode",
        status: "Connection status",
        lastHeartbeat: "Last heartbeat",
        stateUpdated: "State updated",
        message: "State message",
        probe: "Probe connection",
        probeOk: "Connection probe completed",
        probeError: "Connection probe failed",
        stateLoadError: "Failed to load connection state",
        settingsTitle: "Connection settings",
        host: "Host",
        hostHint: "IB Gateway/TWS host address",
        port: "Port",
        portHint: "Paper usually 7497, Live usually 7496",
        clientId: "Client ID",
        clientIdHint: "Brokerage clientId (managed by Lean, avoid conflicts)",
        accountId: "Account ID",
        accountIdPlaceholder: "Optional account id",
        accountIdHint: "Configured account {account}",
        apiMode: "Data source mode",
        apiModeHint: "Data from Lean Bridge; Mock is for offline use",
        apiModeIb: "Lean Bridge",
        apiModeMock: "Mock",
        regulatorySnapshot: "Regulatory snapshot",
        regulatorySnapshotHint: "Enable NBBO regulatory snapshots (may incur per-request fees)",
        mode: "Account mode",
        modeHint: "Paper or Live mode",
        modePaper: "Paper",
        modeLive: "Live",
        marketDataType: "Market data type",
        marketDataTypeHint: "Realtime / frozen / delayed",
        marketDataRealtime: "Realtime",
        marketDataFrozen: "Frozen",
        marketDataDelayed: "Delayed",
        contractsTitle: "Contract cache",
        contractsSymbols: "Symbols",
        contractsSymbolsPlaceholder: "Comma or space separated symbols, e.g. SPY AAPL",
        contractsSymbolsHint: "Refresh symbol→conId contract cache",
        contractsProjectOnly: "Project only",
        contractsProjectOnlyHint: "Use symbols from all active projects",
        contractsRefresh: "Refresh contracts",
        contractsResult: "Refreshed {updated}/{total}, skipped {skipped}, took {duration}s",
        contractsError: "Failed to refresh contract cache",
        healthTitle: "Market health",
        healthSymbols: "Symbols",
        healthSymbolsPlaceholder: "Comma or space separated symbols",
        healthSymbolsHint: "Check market availability (fallback to history if needed)",
        healthProjectOnly: "Project only",
        healthProjectOnlyHint: "Use symbols from all active projects",
        healthMinRatio: "Min success ratio",
        healthMinRatioHint: "Block if below this ratio",
        healthFallback: "Fallback to history",
        healthFallbackHint: "Use historical data when snapshot is unavailable",
        healthDuration: "History window",
        healthDurationHint: "Fallback lookback window",
        healthDuration5d: "Last 5 days",
        healthDuration30d: "Last 30 days",
        healthDuration90d: "Last 90 days",
        healthBarSize: "Bar size",
        healthBarSizeHint: "Fallback bar granularity",
        healthBarDay: "Daily",
        healthBarHour: "Hourly",
        healthUseRth: "RTH only",
        healthUseRthHint: "Use regular trading hours only",
        healthCheck: "Check market",
        healthResult: "Status {status} · {success}/{total} ok",
        healthError: "Market health check failed",
        historyTitle: "History backfill",
        historySymbols: "Symbols",
        historySymbolsPlaceholder: "Comma or space separated symbols",
        historySymbolsHint: "Pull IB historical data for backfill",
        historyProjectOnly: "Project only",
        historyProjectOnlyHint: "Use symbols from all active projects",
        historyDuration: "History window",
        historyDurationHint: "Lookback window for historical data",
        historyDuration5d: "Last 5 days",
        historyDuration30d: "Last 30 days",
        historyDuration90d: "Last 90 days",
        historyDuration1y: "Last 1 year",
        historyBarSize: "Bar size",
        historyBarSizeHint: "Granularity for historical bars",
        historyBarDay: "Daily",
        historyBarHour: "Hourly",
        historyUseRth: "RTH only",
        historyUseRthHint: "Use regular trading hours only",
        historyStore: "Write files",
        historyStoreHint: "Write to data_root/ib/bars",
        historyDelay: "Delay (s)",
        historyDelayHint: "Delay between symbols",
        historyStart: "Start backfill",
        historyLoadError: "Failed to load history jobs",
        historyStartError: "Failed to start history job",
        historyCancel: "Cancel",
        historyCancelError: "Failed to cancel history job",
        historyProgress: "Progress",
        historySuccess: "Success/Fail",
        historyEmpty: "No history jobs",
        streamTitle: "Market Stream",
        streamMeta: "Subscribe Lean Bridge L1 stream and write ticks to stream files",
        streamStatus: "Stream status",
        streamLastHeartbeat: "Stream heartbeat",
        streamSubscribed: "Subscribed symbols",
        streamErrorCount: "Error count",
        streamLastError: "Last error",
        streamMarketDataType: "Market data type",
        streamProjectId: "Project ID",
        streamProjectIdHint: "Used to build subscription universe",
        streamDecisionSnapshotId: "Snapshot ID",
        streamDecisionSnapshotIdHint: "Optional, prefer snapshot symbols",
        streamMaxSymbols: "Max symbols",
        streamMaxSymbolsHint: "Limit subscription size",
        streamMarketDataTypeHint: "Market data type for subscription",
        streamStart: "Start stream",
        streamStop: "Stop stream",
        streamRefresh: "Refresh status",
        streamLoadError: "Failed to load stream status",
        streamStartError: "Failed to start stream",
        streamStopError: "Failed to stop stream",
        streamProjectRequired: "Project ID is required",
        saved: "Brokerage settings saved",
        loadError: "Failed to load brokerage settings",
        saveError: "Failed to save brokerage settings",
      },
    },
    trade: {
      title: "Live Trading",
      meta: "Brokerage execution status and runtime overview",
      overviewTitle: "Connection Overview",
      overviewMeta: "Aggregated brokerage connection and execution health",
      overviewPartial: "Some metrics are unavailable",
      overviewError: "Failed to load connection overview",
      overviewRefresh: "Refresh Overview",
      overviewStatusLabel: "Connection Status",
      overviewRefreshedAt: "Refreshed at",
      overviewStreamLabel: "Market Stream",
      overviewStreamCount: "Subscriptions",
      overviewSnapshotLabel: "Snapshot Cache",
      overviewSnapshotAt: "Latest Snapshot",
      bridgeLabel: "Lean Bridge Data",
      bridgeSource: "Source",
      bridgeUpdatedAt: "Last Update",
      overviewOrderLabel: "Latest Order",
      overviewOrderAt: "Order Time",
      overviewAlertLabel: "Latest Alert",
      overviewAlertAt: "Alert Time",
      snapshotTitle: "Market Snapshot",
      snapshotMeta: "Latest price and volume overview",
      snapshotEmpty: "No snapshot available",
      snapshotVolume: "Volume",
      snapshotUpdatedAt: "Updated at",
      snapshotRefresh: "Refresh Snapshot",
      snapshotError: "Failed to load market snapshot",
      overview: {
        status: {
          ok: "OK",
          down: "Down",
          partial: "Partial",
          unknown: "Unknown",
        },
      },
      bridgeStatus: {
        ok: "OK",
        stale: "Stale",
        unknown: "Unknown",
      },
      statusTitle: "Trading Status",
      statusMeta: "Brokerage connection and configuration status",
      statusLabel: "Status",
      statusHint: "Brokerage settings are not configured. Please update settings in Data page.",
      liveWarning: "Live mode is enabled. Confirm account and risk settings before execution.",
      status: {
        unconfigured: "Not configured",
        unknown: "Unknown",
        connected: "Connected",
        disconnected: "Disconnected",
      },
      connectionUpdatedAt: "Status updated at",
      modeLabel: "Account Mode",
      mode: {
        paper: "Paper",
        live: "Live",
      },
      marketDataType: "Market Data Type",
      configTitle: "Account Settings",
      configMeta: "Current IB configuration (sensitive fields masked)",
      host: "Host",
      port: "Port",
      account: "Account",
      apiMode: "API Mode",
      regulatorySnapshot: "Regulatory Snapshot",
      accountSummaryTitle: "Account Summary",
      accountSummaryMeta: "Lean bridge account snapshot",
      accountSummaryUpdatedAt: "Last updated",
      accountSummarySource: "Source",
      accountSummaryStale: "Stale",
      accountSummaryRefresh: "Refresh Full Tags",
      accountSummaryFullTitle: "Full Account Tags",
      accountSummaryFullEmpty: "No summary data",
      accountSummaryTag: "Tag",
      accountSummaryValue: "Value",
      accountSummaryError: "Failed to load account summary",
      accountPositionsTitle: "Positions",
      accountPositionsMeta: "Lean bridge position snapshot",
      accountPositionsUpdatedAt: "Last updated",
      accountPositionsEmpty: "No positions or not refreshed",
      accountPositionsError: "Failed to load positions",
      accountPositionsStaleHint:
        "Positions are empty and data is stale. Lean Bridge may not be updating. Check Lean status or click refresh.",
      accountPositionsStaleUpdatedAt: "Bridge heartbeat",
      accountPositionsRefresh: "Refresh positions",
      positionTable: {
        symbol: "Symbol",
        position: "Position",
        avgCost: "Avg Cost",
        marketPrice: "Market Price",
        marketValue: "Market Value",
        unrealized: "Unrealized PnL",
        realized: "Realized PnL",
        account: "Account",
        currency: "Currency",
      },
      openData: "Open Data Settings",
      refresh: "Refresh Status",
      errorLoad: "Failed to load. Check backend service.",
      dataTitle: "Live Data Status",
      dataMeta: "IB contract cache and history jobs",
      dataError: "Failed to load live data status",
      contractCache: "Contract Cache",
      contractCacheHint: "Only first 200 cached symbols shown",
      historyJob: "History Jobs",
      historyJobEmpty: "No history jobs",
      historyTable: {
        id: "Job ID",
        status: "Status",
        progress: "Progress",
        updatedAt: "Updated",
      },
      guardTitle: "Intraday Guard",
      guardMeta: "Intraday risk status and valuation source",
      guardStatus: "Guard Status",
      guardEquity: "Latest Equity",
      guardDrawdown: "Drawdown",
      guardValuationSource: "Valuation Source",
      guardValuationTime: "Valuation Time",
      guardCooldown: "Cooldown Until",
      guardOrderFailures: "Order Failures",
      guardMarketErrors: "Market Data Errors",
      guardRiskTriggers: "Risk Triggers",
      guardReason: "Halt Reason",
      guardEmpty: "No guard state",
      guardError: "Failed to load guard state",
      projectBindingTitle: "Project Binding",
      projectBindingMeta: "Bind project and latest decision snapshot",
      projectSelect: "Select Project",
      projectSelectPlaceholder: "Select a project",
      projectSelectHint: "Select a project before executing.",
      projectBindingSelected: "Bound project: #{id} · {name}",
      projectLoadError: "Failed to load projects",
      snapshotStatus: "Snapshot Status",
      snapshotReady: "Ready",
      snapshotMissing: "Snapshot not generated. Execution blocked.",
      snapshotDate: "Snapshot Date",
      snapshotId: "Snapshot ID",
      snapshotLoadError: "Failed to load snapshot",
      executeContext: "Execution Context",
      executeBlockedProject: "Select a project before executing.",
      executeBlockedSnapshot: "Snapshot not generated. Execution blocked.",
      projectShort: "Project #",
      id: {
        project: "Project",
        snapshot: "Snapshot",
        run: "Run",
      },
      executionTitle: "Execution & Risk",
      executionMeta: "Latest trade runs and execution status",
      executionDataSource: "Execution Data Source",
      signalDataSource: "Signal Data Source",
      signalDataSourceValue: "Alpha (training/backtest)",
      tradeSettingsError: "Failed to load trade settings",
      tradeError: "Failed to load trade execution data",
      latestRun: "Latest Run",
      runMode: "Run Mode",
      runProject: "Project",
      runEmpty: "No trade runs",
      runTable: {
        id: "Run ID",
        status: "Status",
        mode: "Mode",
        snapshot: "Decision Snapshot",
        createdAt: "Created",
      },
      runSelect: "Select Run",
      runSelectHint: "Select a trade run to view target vs fills",
      detailRefresh: "Refresh Details",
      detailError: "Failed to load run details",
      symbolSummaryTitle: "Target vs Fill Summary",
      symbolSummaryMeta: "Compare target weights with executed fills",
      symbolSummaryUpdatedAt: "Details updated",
      symbolSummaryEmpty: "No summary data",
      symbolTable: {
        symbol: "Symbol",
        targetWeight: "Target Weight",
        targetValue: "Target Value",
        filledQty: "Filled Qty",
        avgPrice: "Avg Price",
        filledValue: "Filled Value",
        pendingQty: "Pending Qty",
        deltaValue: "Delta Value",
        deltaWeight: "Delta Weight",
        fillRatio: "Fill Ratio",
        status: "Last Status",
      },
      ordersTitle: "Orders",
      fillsTitle: "Fills",
      fillsEmpty: "No fills",
      fillTable: {
        orderId: "Order",
        execId: "Exec ID",
        qty: "Qty",
        price: "Price",
        commission: "Commission",
        exchange: "Exchange",
        time: "Time",
      },
      executeRunId: "Run ID to Execute",
      executeRunIdHint: "Enter the trade run ID to execute (defaults to latest)",
      executeToken: "Live Confirmation Token",
      executeTokenHint: "Required for live execution only",
      executeSubmit: "Execute Trade Run",
      executeSuccess: "Execution request submitted",
      executeError: "Execution request failed",
      executeRunRequired: "Please enter a valid trade run ID",
      monitorTitle: "Live Monitor",
      monitorMeta: "Recent orders and execution details",
      orderEmpty: "No orders",
      orderTable: {
        id: "Order ID",
        symbol: "Symbol",
        side: "Side",
        qty: "Qty",
        status: "Status",
        createdAt: "Created",
      },
    },
    pagination: {
      prev: "Prev",
      next: "Next",
      page: "Page {page} / {pages}",
      total: "Total {total}",
      range: "Showing {start}-{end}",
      pageSize: "Per page",
    },
    audit: {
      title: "Audit Logs",
      filters: {
        title: "Filters",
        meta: "Supports action / resource_type / resource_id",
        action: "action (backtest.create)",
        resourceType: "resource_type (dataset)",
        resourceId: "resource_id (number)",
      },
      table: {
        id: "ID",
        time: "Time",
        action: "Action",
        resource: "Resource",
        detail: "Details",
        empty: "No audit logs",
      },
    },
  },
};

type I18nContextValue = {
  locale: Locale;
  setLocale: (locale: Locale) => void;
  timeZone: TimeZone;
  setTimeZone: (zone: TimeZone) => void;
  t: (key: string, vars?: Record<string, string | number>) => string;
  formatDateTime: (value?: string | number | Date | null) => string;
};

const I18nContext = createContext<I18nContextValue>({
  locale: "zh",
  setLocale: () => undefined,
  timeZone: "America/New_York",
  setTimeZone: () => undefined,
  t: (key) => key,
  formatDateTime: (value) => String(value ?? ""),
});

const resolveMessage = (obj: MessageTree, key: string): string | undefined => {
  const parts = key.split(".");
  let current: MessageTree | string | undefined = obj;
  for (const part of parts) {
    if (!current || typeof current === "string") {
      return undefined;
    }
    current = current[part];
  }
  return typeof current === "string" ? current : undefined;
};

const applyVars = (text: string, vars?: Record<string, string | number>): string => {
  if (!vars) {
    return text;
  }
  return text.replace(/\{(\w+)\}/g, (match, key) => {
    if (Object.prototype.hasOwnProperty.call(vars, key)) {
      return String(vars[key]);
    }
    return match;
  });
};

const detectLocale = (): Locale => {
  if (typeof window === "undefined") {
    return "zh";
  }
  const stored = window.localStorage.getItem("locale");
  if (stored === "zh" || stored === "en") {
    return stored;
  }
  const browser = navigator.language.toLowerCase();
  return browser.startsWith("zh") ? "zh" : "en";
};

const TIMEZONE_STORAGE_KEY = "timezone";
const DEFAULT_TIMEZONE: TimeZone = "America/New_York";
const TIMEZONE_OPTIONS: TimeZone[] = [
  "America/New_York",
  "UTC",
  "Asia/Shanghai",
  "Asia/Hong_Kong",
];

const detectTimeZone = (): TimeZone => {
  if (typeof window === "undefined") {
    return DEFAULT_TIMEZONE;
  }
  const stored = window.localStorage.getItem(TIMEZONE_STORAGE_KEY);
  if (stored && TIMEZONE_OPTIONS.includes(stored as TimeZone)) {
    return stored as TimeZone;
  }
  return DEFAULT_TIMEZONE;
};

export const I18nProvider = ({ children }: { children: React.ReactNode }) => {
  const [locale, setLocaleState] = useState<Locale>(detectLocale);
  const [timeZone, setTimeZoneState] = useState<TimeZone>(detectTimeZone);
  const setLocale = (next: Locale) => {
    setLocaleState(next);
    if (typeof window !== "undefined") {
      window.localStorage.setItem("locale", next);
    }
  };
  const setTimeZone = (next: TimeZone) => {
    setTimeZoneState(next);
    if (typeof window !== "undefined") {
      window.localStorage.setItem(TIMEZONE_STORAGE_KEY, next);
    }
  };

  const value = useMemo<I18nContextValue>(() => {
    const t = (key: string, vars?: Record<string, string | number>) => {
      const text = resolveMessage(messages[locale], key) || key;
      return applyVars(text, vars);
    };
    const formatDateTime = (value?: string | number | Date | null) => {
      if (!value) {
        return t("common.none");
      }
      const normalizeDate = () => {
        if (value instanceof Date) {
          return value;
        }
        if (typeof value === "number") {
          return new Date(value);
        }
        if (typeof value === "string") {
          const trimmed = value.trim();
          if (!trimmed) {
            return null;
          }
          const hasTimeZone = /[zZ]|[+-]\d{2}:?\d{2}$/.test(trimmed);
          const hasTime = /T|\d{2}:\d{2}/.test(trimmed);
          if (!hasTimeZone && hasTime) {
            return new Date(`${trimmed}Z`);
          }
          return new Date(trimmed);
        }
        return null;
      };
      const date = normalizeDate();
      if (!date || Number.isNaN(date.getTime())) {
        return t("common.none");
      }
      const localeTag = locale === "zh" ? "zh-CN" : "en-US";
      try {
        return new Intl.DateTimeFormat(localeTag, {
          timeZone,
          year: "numeric",
          month: "2-digit",
          day: "2-digit",
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        }).format(date);
      } catch (err) {
        return date.toLocaleString(localeTag, { timeZone });
      }
    };
    return { locale, setLocale, timeZone, setTimeZone, t, formatDateTime };
  }, [locale, timeZone]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
};

export const useI18n = () => useContext(I18nContext);
